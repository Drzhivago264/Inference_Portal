{"version":3,"file":"ConversationalRetrievalQAChain.js","sourceRoot":"","sources":["../../../../nodes/chains/ConversationalRetrievalQAChain/ConversationalRetrievalQAChain.ts"],"names":[],"mappings":"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"}