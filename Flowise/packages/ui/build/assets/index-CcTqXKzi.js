import{s as T,m as ee,t as k,n as L,o as te,p as ae,u as se,a as s,a7 as re,j as e,M as ie,X as ne,B as m,v as oe,w as le,x as ce,y as de,z as xe,F as he,A as E,a3 as pe,a4 as me,q as N,k as je,l as Ce}from"./index-BgTNlE3K.js";import{u as A,S as M,a as ue,B as P}from"./useApi-H2a3O-a6.js";import{C as ge,A as fe,c as j}from"./CredentialListDialog-CbgBEUU8.js";import{u as Se,a as ye,S as i,I as B,C as be}from"./useNotifier-C3gm9LlJ.js";import{E as De,V as we}from"./ErrorBoundary-DJvKZGfQ.js";import"./TooltipWithParser-Ct71_EQj.js";import"./Dropdown-CBMARjVX.js";import"./TextField-dkTUQuhn.js";import"./FormControl-D-oBzX_C.js";import"./Input-DweKhHD3.js";const ve="/assets/credential_empty-BUL4Jfyn.svg",a=T(ee)(({theme:n})=>({borderColor:n.palette.grey[900]+25,padding:"6px 16px",[`&.${k.head}`]:{color:n.palette.grey[900]},[`&.${k.body}`]:{fontSize:14,height:64}})),C=T(L)(()=>({"&:last-child td, &:last-child th":{border:0}})),$e=()=>{const n=te(),u=ae(t=>t.customization),c=se();Se();const g=(...t)=>c(je(...t)),f=(...t)=>c(Ce(...t)),[S,R]=s.useState(!0),[y,b]=s.useState(null),[Y,d]=s.useState(!1),[$,q]=s.useState({}),[F,x]=s.useState(!1),[I,D]=s.useState({}),[w,z]=s.useState([]),[V,O]=s.useState([]),{confirm:U}=ye(),r=A(j.getAllCredentials),o=A(j.getAllComponentsCredentials),[X,_]=s.useState(""),G=t=>{_(t.target.value)};function H(t){return t.credentialName.toLowerCase().indexOf(X.toLowerCase())>-1}const J=()=>{q({title:"Add New Credential",componentsCredentials:V}),d(!0)},K=t=>{D({type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",credentialComponent:t}),x(!0)},W=t=>{D({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:t}),x(!0)},Q=async t=>{const l={title:"Delete",description:`Delete credential ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await U(l))try{(await j.deleteCredential(t.id)).data&&(g({message:"Credential deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:p=>e.jsx(P,{style:{color:"white"},onClick:()=>f(p),children:e.jsx(N,{})})}}),v())}catch(h){g({message:`Failed to delete Credential: ${typeof h.response.data=="object"?h.response.data.message:h.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:p=>e.jsx(P,{style:{color:"white"},onClick:()=>f(p),children:e.jsx(N,{})})}}),onCancel()}},Z=t=>{d(!1),K(t)},v=()=>{d(!1),x(!1),r.request()};return s.useEffect(()=>{r.request(),o.request()},[]),s.useEffect(()=>{R(r.loading)},[r.loading]),s.useEffect(()=>{r.data&&z(r.data)},[r.data]),s.useEffect(()=>{r.error&&b(r.error)},[r.error]),s.useEffect(()=>{o.data&&(O(o.data),c({type:re,componentsCredentials:o.data}))},[o.data,c]),e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:y?e.jsx(De,{error:y}):e.jsxs(M,{flexDirection:"column",sx:{gap:3},children:[e.jsx(we,{onSearchChange:G,search:!0,searchPlaceholder:"Search Credentials",title:"Credentials",children:e.jsx(ue,{variant:"contained",sx:{borderRadius:2,height:"100%"},onClick:J,startIcon:e.jsx(ne,{}),children:"Add Credential"})}),!S&&w.length<=0?e.jsxs(M,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(m,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:ve,alt:"CredentialEmptySVG"})}),e.jsx("div",{children:"No Credentials Yet"})]}):e.jsx(oe,{sx:{border:1,borderColor:n.palette.grey[900]+25,borderRadius:2},component:le,children:e.jsxs(ce,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(de,{sx:{backgroundColor:u.isDarkMode?n.palette.common.black:n.palette.grey[100],height:56},children:e.jsxs(L,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Last Updated"}),e.jsx(a,{children:"Created"}),e.jsx(a,{children:" "}),e.jsx(a,{children:" "})]})}),e.jsx(xe,{children:S?e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})})]}),e.jsxs(C,{children:[e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})}),e.jsx(a,{children:e.jsx(i,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:w.filter(H).map((t,l)=>e.jsxs(C,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(a,{scope:"row",children:e.jsxs(m,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(m,{sx:{width:35,height:35,borderRadius:"50%",backgroundColor:u.isDarkMode?n.palette.common.white:n.palette.grey[300]+75},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},alt:t.credentialName,src:`${he}/api/v1/components-credentials-icon/${t.credentialName}`})}),t.name]})}),e.jsx(a,{children:E(t.updatedDate).format("MMMM Do, YYYY")}),e.jsx(a,{children:E(t.createdDate).format("MMMM Do, YYYY")}),e.jsx(a,{children:e.jsx(B,{title:"Edit",color:"primary",onClick:()=>W(t),children:e.jsx(pe,{})})}),e.jsx(a,{children:e.jsx(B,{title:"Delete",color:"error",onClick:()=>Q(t),children:e.jsx(me,{})})})]},l))})})]})})]})}),e.jsx(ge,{show:Y,dialogProps:$,onCancel:()=>d(!1),onCredentialSelected:Z}),e.jsx(fe,{show:F,dialogProps:I,onCancel:()=>x(!1),onConfirm:v,setError:b}),e.jsx(be,{})]})};export{$e as default};
