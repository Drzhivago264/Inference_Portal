import{r as _,i as T,j as e,P as r,a as s,D as L,b as A,c as F,B as R,C as De,T as le,u as V,S as K,H as $,d as X,s as ce,e as tt,f as ve,q as oe,g as at,h as ot,k as st,l as rt,m as lt,t as ye,n as Se,o as we,p as nt,v as it,w as ct,x as dt,y as ut,z as pt,L as ht,A as xt,E as mt,F as gt,M as ft,G as jt,I as vt,X as yt,J as be}from"./index-BgTNlE3K.js";import{I as bt}from"./ItemCard-C3XUgP8C.js";import{T as Ct,W as Dt}from"./workflow_empty-Dwp_c8Jm.js";import{L as St}from"./LoginDialog-CCDVO589.js";import{u as B,a as wt,S as y,C as _t}from"./useNotifier-C3gm9LlJ.js";import{c as ne}from"./chatflows-CuZYxTR0.js";import{D as Tt,B as z,u as _e,S as ie,T as Ce,a as kt}from"./useApi-H2a3O-a6.js";import{M as w,d as Mt}from"./Delete-C5-Z8bWn.js";import{S as $t,C as zt,A as Rt,a as Pt,b as Ot}from"./SpeechToText-BINBtG6m.js";import{T as It,M as Et}from"./TextField-dkTUQuhn.js";import{T as Lt}from"./TooltipWithParser-Ct71_EQj.js";import{E as At,V as Ft}from"./ErrorBoundary-DJvKZGfQ.js";import"./Grid-Cq2i7Qbd.js";import"./Input-DweKhHD3.js";import"./FormControl-D-oBzX_C.js";import"./CredentialListDialog-CbgBEUU8.js";import"./Dropdown-CBMARjVX.js";import"./CredentialInputHandler-Tm9MuCGQ.js";var de={},Vt=T;Object.defineProperty(de,"__esModule",{value:!0});var Te=de.default=void 0,Bt=Vt(_()),Nt=e,Wt=(0,Bt.default)((0,Nt.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");Te=de.default=Wt;var ue={},qt=T;Object.defineProperty(ue,"__esModule",{value:!0});var ke=ue.default=void 0,Ht=qt(_()),Ut=e,Gt=(0,Ht.default)((0,Ut.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"}),"FileCopy");ke=ue.default=Gt;var pe={},Yt=T;Object.defineProperty(pe,"__esModule",{value:!0});var Me=pe.default=void 0,Jt=Yt(_()),Kt=e,Xt=(0,Jt.default)((0,Kt.jsx)("path",{d:"M18.32 4.26C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62l1.42-1.43zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9zm-1.62 5.9 1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89zM13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62zM13 12V7h-2v5H7l5 5 5-5h-4zm-2 7.93v2.02c-5.05-.5-9-4.76-9-9.95s3.95-9.45 9-9.95v2.02C7.05 4.56 4 7.92 4 12s3.05 7.44 7 7.93z"}),"Downloading");Me=pe.default=Xt;var he={},Qt=T;Object.defineProperty(he,"__esModule",{value:!0});var $e=he.default=void 0,Zt=Qt(_()),se=e,ea=(0,Zt.default)([(0,se.jsx)("path",{d:"m12 2-5.5 9h11z"},"0"),(0,se.jsx)("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),(0,se.jsx)("path",{d:"M3 13.5h8v8H3z"},"2")],"Category");$e=he.default=ea;var xe={},ta=T;Object.defineProperty(xe,"__esModule",{value:!0});var ze=xe.default=void 0,aa=ta(_()),oa=e,sa=(0,aa.default)((0,oa.jsx)("path",{d:"M19 11h-8v6h8v-6zm4 8V4.98C23 3.88 22.1 3 21 3H3c-1.1 0-2 .88-2 1.98V19c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H3V4.97h18v14.05z"}),"PictureInPictureAlt");ze=xe.default=sa;var me={},ra=T;Object.defineProperty(me,"__esModule",{value:!0});var Re=me.default=void 0,la=ra(_()),na=e,ia=(0,la.default)((0,na.jsx)("path",{d:"M12 6c0-.55-.45-1-1-1H5.82l.66-3.18.02-.23c0-.31-.13-.59-.33-.8L5.38 0 .44 4.94C.17 5.21 0 5.59 0 6v6.5c0 .83.67 1.5 1.5 1.5h6.75c.62 0 1.15-.38 1.38-.91l2.26-5.29c.07-.17.11-.36.11-.55V6zm-2 1.13L7.92 12H2V6.21l1.93-1.93L3.36 7H10v.13zM22.5 10h-6.75c-.62 0-1.15.38-1.38.91l-2.26 5.29c-.07.17-.11.36-.11.55V18c0 .55.45 1 1 1h5.18l-.66 3.18-.02.24c0 .31.13.59.33.8l.79.78 4.94-4.94c.27-.27.44-.65.44-1.06v-6.5c0-.83-.67-1.5-1.5-1.5zm-.5 7.79-1.93 1.93.57-2.72H14v-.13L16.08 12H22v5.79z"}),"ThumbsUpDownOutlined");Re=me.default=ia;var ge={},ca=T;Object.defineProperty(ge,"__esModule",{value:!0});var Pe=ge.default=void 0,da=ca(_()),ua=e,pa=(0,da.default)((0,ua.jsx)("path",{d:"M18.92 12c.04.33.08.66.08 1 0 2.08-.8 3.97-2.1 5.39-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H7v-2h2c.55 0 1-.45 1-1V8h2c1.1 0 2-.9 2-2V3.46c-.95-.3-1.95-.46-3-.46C5.48 3 1 7.48 1 13s4.48 10 10 10 10-4.48 10-10c0-.34-.02-.67-.05-1h-2.03zM10 20.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L8 16v1c0 1.1.9 2 2 2v1.93zM22 4v-.5C22 2.12 20.88 1 19.5 1S17 2.12 17 3.5V4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h5c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zm-1 0h-3v-.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V4z"}),"VpnLockOutlined");Pe=ge.default=pa;var fe={},ha=T;Object.defineProperty(fe,"__esModule",{value:!0});var Oe=fe.default=void 0,xa=ha(_()),ma=e,ga=(0,xa.default)((0,ma.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"}),"MicNoneOutlined");Oe=fe.default=ga;var je={},fa=T;Object.defineProperty(je,"__esModule",{value:!0});var Ie=je.default=void 0,ja=fa(_()),va=e,ya=(0,ja.default)((0,va.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");Ie=je.default=ya;const Ee=({isOpen:t,dialogProps:a,onClose:i,onSubmit:m})=>{const[o,u]=s.useState(""),[c,j]=s.useState([]),n=g=>{u(g.target.value)},k=g=>{g.key==="Enter"&&o.trim()&&(g.preventDefault(),c.includes(o)||(j([...c,o]),u("")))},C=g=>{j(c.filter(b=>b!==g))},D=g=>{g.preventDefault();let b=[...c];o.trim()&&!c.includes(o)&&(b=[...b,o],j(b)),m(b)};return s.useEffect(()=>(a.category&&j(a.category),()=>{u(""),j([])}),[a]),e.jsxs(L,{fullWidth:!0,maxWidth:"xs",open:t,onClose:i,"aria-labelledby":"category-dialog-title","aria-describedby":"category-dialog-description",children:[e.jsx(A,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:"Set Chatflow Category Tags"}),e.jsx(F,{children:e.jsx(R,{children:e.jsxs("form",{onSubmit:D,children:[c.length>0&&e.jsx("div",{style:{marginBottom:10},children:c.map((g,b)=>e.jsx(De,{label:g,onDelete:()=>C(g),style:{marginRight:5,marginBottom:5}},b))}),e.jsx(It,{sx:{mt:2},fullWidth:!0,value:o,onChange:n,onKeyDown:k,label:"Add a tag",variant:"outlined"}),e.jsx(le,{variant:"body2",sx:{fontStyle:"italic",mt:1},color:"text.secondary",children:"Enter a tag and press enter to add it to the list. You can add as many tags as you want."})]})})}),e.jsxs(Tt,{children:[e.jsx(z,{onClick:i,children:"Cancel"}),e.jsx(z,{variant:"contained",onClick:D,children:"Submit"})]})]})};Ee.propTypes={isOpen:r.bool,dialogProps:r.object,onClose:r.func,onSubmit:r.func};const Le=({show:t,dialogProps:a,onCancel:i})=>{const m=document.getElementById("portal"),o=V();B(),s.useEffect(()=>(o(t?{type:K}:{type:$}),()=>o({type:$})),[t,o]);const u=t?e.jsxs(L,{onClose:i,open:t,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title||"Conversation Starter Prompts"}),e.jsx(F,{children:e.jsx($t,{dialogProps:a})})]}):null;return X.createPortal(u,m)};Le.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onConfirm:r.func};const Ae=({show:t,dialogProps:a,onCancel:i})=>{const m=document.getElementById("portal"),o=V();B(),s.useEffect(()=>(o(t?{type:K}:{type:$}),()=>o({type:$})),[t,o]);const u=t?e.jsxs(L,{onClose:i,open:t,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title||"Allowed Domains"}),e.jsx(F,{children:e.jsx(zt,{dialogProps:a})})]}):null;return X.createPortal(u,m)};Ae.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onConfirm:r.func};const Fe=({show:t,dialogProps:a,onCancel:i})=>{const m=document.getElementById("portal"),o=V();B(),s.useEffect(()=>(o(t?{type:K}:{type:$}),()=>o({type:$})),[t,o]);const u=t?e.jsxs(L,{onClose:i,open:t,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title||"Allowed Domains"}),e.jsx(F,{children:e.jsx(Rt,{dialogProps:a})})]}):null;return X.createPortal(u,m)};Fe.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onConfirm:r.func};const Ve=({show:t,dialogProps:a,onCancel:i})=>{const m=document.getElementById("portal"),o=V();B(),s.useEffect(()=>(o(t?{type:K}:{type:$}),()=>o({type:$})),[t,o]);const u=t?e.jsxs(L,{onClose:i,open:t,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:a.title||"Allowed Domains"}),e.jsx(F,{children:e.jsx(Pt,{dialogProps:a})})]}):null;return X.createPortal(u,m)};Ve.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onConfirm:r.func};const ba=ce(t=>e.jsx(Et,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...t}))(({theme:t})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:t.spacing(1),minWidth:180,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:t.palette.text.secondary,marginRight:t.spacing(1.5)},"&:active":{backgroundColor:tt(t.palette.primary.main,t.palette.action.selectedOpacity)}}}}));function Be({chatflow:t,setError:a,updateFlowsApi:i}){const{confirm:m}=wt(),o=V(),u=_e(ne.updateChatflow);B();const c=(...x)=>o(st(...x)),j=(...x)=>o(rt(...x)),[n,k]=s.useState(!1),[C,D]=s.useState(!1),[g,b]=s.useState({}),[p,f]=s.useState(null),P=!!p,[Q,N]=s.useState(!1),[W,Z]=s.useState({}),[ee,q]=s.useState(!1),[H,U]=s.useState({}),[G,l]=s.useState(!1),[h,M]=s.useState({}),[te,ae]=s.useState(!1),[Y,O]=s.useState({}),J=x=>{f(x.currentTarget)},We=()=>{f(null)},qe=()=>{f(null),k(!0)},He=()=>{f(null),Z({title:"Starter Prompts - "+t.name,chatflow:t}),N(!0)},Ue=()=>{f(null),U({title:"Chat Feedback - "+t.name,chatflow:t}),q(!0)},Ge=()=>{f(null),M({title:"Allowed Domains - "+t.name,chatflow:t}),l(!0)},Ye=()=>{f(null),O({title:"Speech To Text - "+t.name,chatflow:t}),ae(!0)},Je=async x=>{const I={name:x,chatflow:t};try{await u.request(t.id,I),await i.request()}catch(v){a(v),c({message:typeof v.response.data=="object"?v.response.data.message:v.response.data,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:S=>e.jsx(z,{style:{color:"white"},onClick:()=>j(S),children:e.jsx(oe,{})})}})}},Ke=()=>{f(null),t.category&&b({category:t.category.split(";")}),D(!0)},Xe=async x=>{D(!1);const v={category:x.join(";"),chatflow:t};try{await u.request(t.id,v),await i.request()}catch(S){a(S),c({message:typeof S.response.data=="object"?S.response.data.message:S.response.data,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:E=>e.jsx(z,{style:{color:"white"},onClick:()=>j(E),children:e.jsx(oe,{})})}})}},Qe=async()=>{f(null);const x={title:"Delete",description:`Delete chatflow ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await m(x))try{await ne.deleteChatflow(t.id),await i.request()}catch(v){a(v),c({message:typeof v.response.data=="object"?v.response.data.message:v.response.data,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:S=>e.jsx(z,{style:{color:"white"},onClick:()=>j(S),children:e.jsx(oe,{})})}})}},Ze=()=>{f(null);try{localStorage.setItem("duplicatedFlowData",t.flowData),window.open(`${at}/canvas`,"_blank")}catch(x){console.error(x)}},et=()=>{f(null);try{const x=JSON.parse(t.flowData);let I=JSON.stringify(ot(x),null,2),v="data:application/json;charset=utf-8,"+encodeURIComponent(I),S=`${t.name} Chatflow.json`,E=document.createElement("a");E.setAttribute("href",v),E.setAttribute("download",S),E.click()}catch(x){console.error(x)}};return e.jsxs("div",{children:[e.jsx(z,{id:"demo-customized-button","aria-controls":P?"demo-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":P?"true":void 0,disableElevation:!0,onClick:J,endIcon:e.jsx(Ie,{}),children:"Options"}),e.jsxs(ba,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},anchorEl:p,open:P,onClose:We,children:[e.jsxs(w,{onClick:qe,disableRipple:!0,children:[e.jsx(Te,{}),"Rename"]}),e.jsxs(w,{onClick:Ze,disableRipple:!0,children:[e.jsx(ke,{}),"Duplicate"]}),e.jsxs(w,{onClick:et,disableRipple:!0,children:[e.jsx(Me,{}),"Export"]}),e.jsx(ve,{sx:{my:.5}}),e.jsxs(w,{onClick:He,disableRipple:!0,children:[e.jsx(ze,{}),"Starter Prompts"]}),e.jsxs(w,{onClick:Ue,disableRipple:!0,children:[e.jsx(Re,{}),"Chat Feedback"]}),e.jsxs(w,{onClick:Ge,disableRipple:!0,children:[e.jsx(Pe,{}),"Allowed Domains"]}),e.jsxs(w,{onClick:Ye,disableRipple:!0,children:[e.jsx(Oe,{}),"Speech To Text"]}),e.jsxs(w,{onClick:Ke,disableRipple:!0,children:[e.jsx($e,{}),"Update Category"]}),e.jsx(ve,{sx:{my:.5}}),e.jsxs(w,{onClick:Qe,disableRipple:!0,children:[e.jsx(Mt,{}),"Delete"]})]}),e.jsx(Ot,{show:n,dialogProps:{title:"Rename Chatflow",confirmButtonName:"Rename",cancelButtonName:"Cancel"},onCancel:()=>k(!1),onConfirm:Je}),e.jsx(Ee,{isOpen:C,dialogProps:g,onClose:()=>D(!1),onSubmit:Xe}),e.jsx(Le,{show:Q,dialogProps:W,onCancel:()=>N(!1)}),e.jsx(Ae,{show:ee,dialogProps:H,onCancel:()=>q(!1)}),e.jsx(Fe,{show:G,dialogProps:h,onCancel:()=>l(!1)}),e.jsx(Ve,{show:te,dialogProps:Y,onCancel:()=>ae(!1)})]})}Be.propTypes={chatflow:r.object,setError:r.func,updateFlowsApi:r.object};const d=ce(lt)(({theme:t})=>({borderColor:t.palette.grey[900]+25,[`&.${ye.head}`]:{color:t.palette.grey[900]},[`&.${ye.body}`]:{fontSize:14,height:64}})),re=ce(Se)(()=>({"&:last-child td, &:last-child th":{border:0}})),Ne=({data:t,images:a,isLoading:i,filterFunction:m,updateFlowsApi:o,setError:u})=>{const c=we(),j=nt(n=>n.customization);return e.jsx(e.Fragment,{children:e.jsx(it,{sx:{border:1,borderColor:c.palette.grey[900]+25,borderRadius:2},component:ct,children:e.jsxs(dt,{sx:{minWidth:650},size:"small","aria-label":"a dense table",children:[e.jsx(ut,{sx:{backgroundColor:j.isDarkMode?c.palette.common.black:c.palette.grey[100],height:56},children:e.jsxs(Se,{children:[e.jsx(d,{component:"th",scope:"row",style:{width:"20%"},children:"Name"},"0"),e.jsx(d,{style:{width:"25%"},children:"Category"},"1"),e.jsx(d,{style:{width:"30%"},children:"Nodes"},"2"),e.jsx(d,{style:{width:"15%"},children:"Last Modified Date"},"3"),e.jsx(d,{style:{width:"10%"},children:"Actions"},"4")]})}),e.jsx(pt,{children:i?e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})})]}),e.jsxs(re,{children:[e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})}),e.jsx(d,{children:e.jsx(y,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:t==null?void 0:t.filter(m).map((n,k)=>e.jsxs(re,{children:[e.jsx(d,{children:e.jsx(Lt,{title:n.templateName||n.name,children:e.jsx(le,{sx:{display:"-webkit-box",fontSize:14,fontWeight:500,WebkitLineClamp:2,WebkitBoxOrient:"vertical",textOverflow:"ellipsis",overflow:"hidden"},children:e.jsx(ht,{to:`/canvas/${n.id}`,style:{color:"#2196f3",textDecoration:"none"},children:n.templateName||n.name})})})},"0"),e.jsx(d,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",marginTop:5},children:["Â ",n.category&&n.category.split(";").map((C,D)=>e.jsx(De,{label:C,style:{marginRight:5,marginBottom:5}},D))]})},"1"),e.jsx(d,{children:a[n.id]&&e.jsxs(R,{sx:{display:"flex",alignItems:"center",justifyContent:"start",gap:1},children:[a[n.id].slice(0,a[n.id].length>5?5:a[n.id].length).map(C=>e.jsx(R,{sx:{width:30,height:30,borderRadius:"50%",backgroundColor:j.isDarkMode?c.palette.common.white:c.palette.grey[300]+75},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},alt:"",src:C})},C)),a[n.id].length>5&&e.jsxs(le,{sx:{alignItems:"center",display:"flex",fontSize:".9rem",fontWeight:200},children:["+ ",a[n.id].length-5," More"]})]})},"2"),e.jsx(d,{children:xt(n.updatedDate).format("MMMM Do, YYYY")},"3"),e.jsx(d,{children:e.jsx(ie,{direction:{xs:"column",sm:"row"},spacing:1,justifyContent:"center",alignItems:"center",children:e.jsx(Be,{chatflow:n,setError:u,updateFlowsApi:o})})},"4")]},k))})})]})})})};Ne.propTypes={data:r.array,images:r.object,isLoading:r.bool,filterFunction:r.func,updateFlowsApi:r.object,setError:r.func};const Va=()=>{var H,U,G;const t=mt(),a=we(),[i,m]=s.useState(!0),[o,u]=s.useState(null),[c,j]=s.useState({}),[n,k]=s.useState(""),[C,D]=s.useState(!1),[g,b]=s.useState({}),p=_e(ne.getAllChatflows),[f,P]=s.useState(localStorage.getItem("flowDisplayStyle")||"card"),Q=(l,h)=>{h!==null&&(localStorage.setItem("flowDisplayStyle",h),P(h))},N=l=>{k(l.target.value)};function W(l){return l.name.toLowerCase().indexOf(n.toLowerCase())>-1||l.category&&l.category.toLowerCase().indexOf(n.toLowerCase())>-1}const Z=(l,h)=>{localStorage.setItem("username",l),localStorage.setItem("password",h),t(0)},ee=()=>{t("/canvas")},q=l=>{t(`/canvas/${l.id}`)};return s.useEffect(()=>{p.request()},[]),s.useEffect(()=>{var l,h;p.error&&(((h=(l=p.error)==null?void 0:l.response)==null?void 0:h.status)===401?(b({title:"Login",confirmButtonName:"Login"}),D(!0)):u(p.error))},[p.error]),s.useEffect(()=>{m(p.loading)},[p.loading]),s.useEffect(()=>{if(p.data)try{const l=p.data,h={};for(let M=0;M<l.length;M+=1){const te=l[M].flowData,Y=JSON.parse(te).nodes||[];h[l[M].id]=[];for(let O=0;O<Y.length;O+=1){const J=`${gt}/api/v1/node-icon/${Y[O].data.name}`;h[l[M].id].includes(J)||h[l[M].id].push(J)}}j(h)}catch(l){console.error(l)}},[p.data]),e.jsxs(ft,{children:[o?e.jsx(At,{error:o}):e.jsxs(ie,{flexDirection:"column",sx:{gap:3},children:[e.jsxs(Ft,{onSearchChange:N,search:!0,searchPlaceholder:"Search Name or Category",title:"Chatflows",children:[e.jsxs(Ct,{sx:{borderRadius:2,maxHeight:40},value:f,color:"primary",exclusive:!0,onChange:Q,children:[e.jsx(Ce,{sx:{borderColor:a.palette.grey[900]+25,borderRadius:2,color:(H=a==null?void 0:a.customization)!=null&&H.isDarkMode?"white":"inherit"},variant:"contained",value:"card",title:"Card View",children:e.jsx(jt,{})}),e.jsx(Ce,{sx:{borderColor:a.palette.grey[900]+25,borderRadius:2,color:(U=a==null?void 0:a.customization)!=null&&U.isDarkMode?"white":"inherit"},variant:"contained",value:"list",title:"List View",children:e.jsx(vt,{})})]}),e.jsx(kt,{variant:"contained",onClick:ee,startIcon:e.jsx(yt,{}),sx:{borderRadius:2,height:40},children:"Add New"})]}),!f||f==="card"?e.jsx(e.Fragment,{children:i&&!p.data?e.jsxs(R,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:be,children:[e.jsx(y,{variant:"rounded",height:160}),e.jsx(y,{variant:"rounded",height:160}),e.jsx(y,{variant:"rounded",height:160})]}):e.jsx(R,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:be,children:(G=p.data)==null?void 0:G.filter(W).map((l,h)=>e.jsx(bt,{onClick:()=>q(l),data:l,images:c[l.id]},h))})}):e.jsx(Ne,{data:p.data,images:c,isLoading:i,filterFunction:W,updateFlowsApi:p,setError:u}),!i&&(!p.data||p.data.length===0)&&e.jsxs(ie,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(R,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:Dt,alt:"WorkflowEmptySVG"})}),e.jsx("div",{children:"No Chatflows Yet"})]})]}),e.jsx(St,{show:C,dialogProps:g,onConfirm:Z}),e.jsx(_t,{})]})};export{Va as default};
