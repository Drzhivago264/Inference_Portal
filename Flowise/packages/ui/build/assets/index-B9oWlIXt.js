function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{a,j as g,aL as L,E as x,F as E}from"./index-BgTNlE3K.js";import{L as j}from"./LoginDialog-CCDVO589.js";import{c as v}from"./chatflows-CuZYxTR0.js";import{u as C}from"./useApi-H2a3O-a6.js";import"./Input-DweKhHD3.js";import"./FormControl-D-oBzX_C.js";function P(c,m,u,i){return new(u||(u=Promise))(function(p,n){function d(e){try{t(i.next(e))}catch(s){n(s)}}function h(e){try{t(i.throw(e))}catch(s){n(s)}}function t(e){var s;e.done?p(e.value):(s=e.value,s instanceof u?s:new u(function(w){w(s)})).then(d,h)}t((i=i.apply(c,m||[])).next())})}const I=c=>{var{style:m,className:u}=c,i=function(n,d){var h={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&d.indexOf(t)<0&&(h[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var e=0;for(t=Object.getOwnPropertySymbols(n);e<t.length;e++)d.indexOf(t[e])<0&&Object.prototype.propertyIsEnumerable.call(n,t[e])&&(h[t[e]]=n[t[e]])}return h}(c,["style","className"]);const p=a.useRef(null);return a.useEffect(()=>{P(void 0,void 0,void 0,function*(){yield L(()=>import("./web-BEakLIGB.js"),__vite__mapDeps([]))})},[]),a.useEffect(()=>{p.current&&Object.assign(p.current,i)},[i]),g.jsx("flowise-fullchatbot",{ref:p,style:m,class:u})},T=()=>{const c=document.location.pathname.toString().split("/"),m=c[c.length-1]==="chatbot"?"":c[c.length-1],u=x(),[i,p]=a.useState(null),[n,d]=a.useState({}),[h,t]=a.useState(!1),[e,s]=a.useState({}),[w,S]=a.useState(!0),[y,b]=a.useState({}),l=C(v.getSpecificChatflowFromPublicEndpoint),f=C(v.getSpecificChatflow),O=(r,o)=>{localStorage.setItem("username",r),localStorage.setItem("password",o),u(0)};return a.useEffect(()=>{l.request(m)},[]),a.useEffect(()=>{var r,o;l.error&&((o=(r=l.error)==null?void 0:r.response)==null?void 0:o.status)===401&&(localStorage.getItem("username")&&localStorage.getItem("password")?f.request(m):(s({title:"Login",confirmButtonName:"Login"}),t(!0)))},[l.error]),a.useEffect(()=>{var r,o;f.error&&((o=(r=f.error)==null?void 0:r.response)==null?void 0:o.status)===401&&(s({title:"Login",confirmButtonName:"Login"}),t(!0))},[f.error]),a.useEffect(()=>{if(l.data||f.data){const r=l.data||f.data;if(p(r),r.chatbotConfig)try{const o=JSON.parse(r.chatbotConfig);d(o),o.overrideConfig&&(o.overrideConfig.generateNewSession&&(o.overrideConfig.sessionId=Date.now().toString()),b(o.overrideConfig))}catch(o){console.error(o),d({}),b({})}}},[l.data,f.data]),a.useEffect(()=>{S(l.loading||f.loading)},[l.loading,f.loading]),g.jsx(g.Fragment,{children:w?null:g.jsxs(g.Fragment,{children:[!i||i.apikeyid?g.jsx("p",{children:"Invalid Chatbot"}):g.jsx(I,{chatflowid:i.id,apiHost:E,chatflowConfig:y,theme:{chatWindow:n}}),g.jsx(j,{show:h,dialogProps:e,onConfirm:O})]})})};export{T as default};
