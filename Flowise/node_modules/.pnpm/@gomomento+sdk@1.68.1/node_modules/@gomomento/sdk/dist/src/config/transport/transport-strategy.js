"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StaticTransportStrategy = exports.StaticGrpcConfiguration = void 0;
class StaticGrpcConfiguration {
    constructor(props) {
        this.deadlineMillis = props.deadlineMillis;
        this.maxSessionMemoryMb = props.maxSessionMemoryMb;
        if (props.numClients !== undefined && props.numClients !== null) {
            this.numClients = props.numClients;
        }
        else {
            // This is the previously hardcoded value and a safe default for most environments.
            this.numClients = 6;
        }
        this.keepAliveTimeMs = props.keepAliveTimeMs;
        this.keepAliveTimeoutMs = props.keepAliveTimeoutMs;
        this.keepAlivePermitWithoutCalls = props.keepAlivePermitWithoutCalls;
        this.maxSendMessageLength = props.maxSendMessageLength;
        this.maxReceiveMessageLength = props.maxReceiveMessageLength;
    }
    getDeadlineMillis() {
        return this.deadlineMillis;
    }
    getMaxSessionMemoryMb() {
        return this.maxSessionMemoryMb;
    }
    getKeepAliveTimeoutMS() {
        return this.keepAliveTimeoutMs;
    }
    getKeepAliveTimeMS() {
        return this.keepAliveTimeMs;
    }
    getKeepAlivePermitWithoutCalls() {
        return this.keepAlivePermitWithoutCalls;
    }
    withDeadlineMillis(deadlineMillis) {
        return new StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: this.maxSessionMemoryMb,
            numClients: this.numClients,
        });
    }
    withMaxSessionMemoryMb(maxSessionMemoryMb) {
        return new StaticGrpcConfiguration({
            deadlineMillis: this.deadlineMillis,
            maxSessionMemoryMb: maxSessionMemoryMb,
            numClients: this.numClients,
        });
    }
    getMaxSendMessageLength() {
        return this.maxSendMessageLength;
    }
    getMaxReceiveMessageLength() {
        return this.maxReceiveMessageLength;
    }
    getNumClients() {
        return this.numClients;
    }
    withNumClients(numClients) {
        return new StaticGrpcConfiguration({
            deadlineMillis: this.deadlineMillis,
            maxSessionMemoryMb: this.maxSessionMemoryMb,
            numClients: numClients,
        });
    }
}
exports.StaticGrpcConfiguration = StaticGrpcConfiguration;
class StaticTransportStrategy {
    constructor(props) {
        this.grpcConfig = props.grpcConfiguration;
        this.maxIdleMillis = props.maxIdleMillis;
        this.maxClientAgeMillis = props.maxClientAgeMillis;
    }
    getGrpcConfig() {
        return this.grpcConfig;
    }
    getMaxClientAgeMillis() {
        return this.maxClientAgeMillis;
    }
    withGrpcConfig(grpcConfig) {
        return new StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: this.maxIdleMillis,
            maxClientAgeMillis: this.maxClientAgeMillis,
        });
    }
    getMaxIdleMillis() {
        return this.maxIdleMillis;
    }
    withMaxIdleMillis(maxIdleMillis) {
        return new StaticTransportStrategy({
            grpcConfiguration: this.grpcConfig,
            maxIdleMillis: maxIdleMillis,
            maxClientAgeMillis: this.maxClientAgeMillis,
        });
    }
    withMaxClientAgeMillis(maxClientAgeMillis) {
        return new StaticTransportStrategy({
            grpcConfiguration: this.grpcConfig,
            maxIdleMillis: this.maxIdleMillis,
            maxClientAgeMillis: maxClientAgeMillis,
        });
    }
    withClientTimeoutMillis(clientTimeout) {
        return new StaticTransportStrategy({
            grpcConfiguration: this.grpcConfig.withDeadlineMillis(clientTimeout),
            maxIdleMillis: this.maxIdleMillis,
        });
    }
}
exports.StaticTransportStrategy = StaticTransportStrategy;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNwb3J0LXN0cmF0ZWd5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbmZpZy90cmFuc3BvcnQvdHJhbnNwb3J0LXN0cmF0ZWd5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQTZFQSxNQUFhLHVCQUF1QjtJQVVsQyxZQUFZLEtBQTZCO1FBQ3ZDLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDLGNBQWMsQ0FBQztRQUMzQyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsS0FBSyxDQUFDLGtCQUFrQixDQUFDO1FBQ25ELElBQUksS0FBSyxDQUFDLFVBQVUsS0FBSyxTQUFTLElBQUksS0FBSyxDQUFDLFVBQVUsS0FBSyxJQUFJLEVBQUU7WUFDL0QsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDO1NBQ3BDO2FBQU07WUFDTCxtRkFBbUY7WUFDbkYsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUM7U0FDckI7UUFDRCxJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQyxlQUFlLENBQUM7UUFDN0MsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQztRQUNuRCxJQUFJLENBQUMsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLDJCQUEyQixDQUFDO1FBQ3JFLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxLQUFLLENBQUMsb0JBQW9CLENBQUM7UUFDdkQsSUFBSSxDQUFDLHVCQUF1QixHQUFHLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztJQUMvRCxDQUFDO0lBRUQsaUJBQWlCO1FBQ2YsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzdCLENBQUM7SUFFRCxxQkFBcUI7UUFDbkIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDakMsQ0FBQztJQUVELHFCQUFxQjtRQUNuQixPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztJQUNqQyxDQUFDO0lBRUQsa0JBQWtC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REMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0dycGNDb25maWd1cmF0aW9uLCBHcnBjQ29uZmlndXJhdGlvblByb3BzfSBmcm9tICcuL2dycGMtY29uZmlndXJhdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJhbnNwb3J0U3RyYXRlZ3kge1xuICAvKipcbiAgICogQ29uZmlndXJlcyB0aGUgbG93LWxldmVsIGdSUEMgc2V0dGluZ3MgZm9yIHRoZSBNb21lbnRvIGNsaWVudCdzIGNvbW11bmljYXRpb25cbiAgICogd2l0aCB0aGUgTW9tZW50byBzZXJ2ZXIuXG4gICAqIEByZXR1cm5zIHtHcnBjQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIGdldEdycGNDb25maWcoKTogR3JwY0NvbmZpZ3VyYXRpb247XG5cbiAgLyoqXG4gICAqIENvcHkgY29uc3RydWN0b3IgZm9yIG92ZXJyaWRpbmcgdGhlIGdSUEMgY29uZmlndXJhdGlvblxuICAgKiBAcGFyYW0ge0dycGNDb25maWd1cmF0aW9ufSBncnBjQ29uZmlnXG4gICAqIEByZXR1cm5zIHtUcmFuc3BvcnRTdHJhdGVneX0gYSBuZXcgVHJhbnNwb3J0U3RyYXRlZ3kgd2l0aCB0aGUgc3BlY2lmaWVkIGdSUEMgY29uZmlnLlxuICAgKi9cbiAgd2l0aEdycGNDb25maWcoZ3JwY0NvbmZpZzogR3JwY0NvbmZpZ3VyYXRpb24pOiBUcmFuc3BvcnRTdHJhdGVneTtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciB0byB1cGRhdGUgdGhlIGNsaWVudC1zaWRlIHRpbWVvdXRcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNsaWVudFRpbWVvdXRNaWxsaXNcbiAgICogQHJldHVybnMge1RyYW5zcG9ydFN0cmF0ZWd5fSBhIG5ldyBUcmFuc3BvcnRTdHJhdGVneSB3aXRoIHRoZSBzcGVjaWZpZWQgY2xpZW50IHRpbWVvdXRcbiAgICovXG4gIHdpdGhDbGllbnRUaW1lb3V0TWlsbGlzKGNsaWVudFRpbWVvdXRNaWxsaXM6IG51bWJlcik6IFRyYW5zcG9ydFN0cmF0ZWd5O1xuXG4gIC8qKlxuICAgKiBUaGUgbWF4aW11bSBkdXJhdGlvbiBmb3Igd2hpY2ggYSBjb25uZWN0aW9uIG1heSByZW1haW4gaWRsZSBiZWZvcmUgYmVpbmcgcmVwbGFjZWQuICBUaGlzXG4gICAqIHNldHRpbmcgY2FuIGJlIHVzZWQgdG8gZm9yY2UgcmUtY29ubmVjdGlvbiBvZiBhIGNsaWVudCBpZiBpdCBoYXMgYmVlbiBpZGxlIGZvciB0b28gbG9uZy5cbiAgICogSW4gZW52aXJvbm1lbnRzIHN1Y2ggYXMgQVdTIGxhbWJkYSwgaWYgdGhlIGxhbWJkYSBpcyBzdXNwZW5kZWQgZm9yIHRvbyBsb25nIHRoZSBjb25uZWN0aW9uXG4gICAqIG1heSBiZSBjbG9zZWQgYnkgdGhlIGxvYWQgYmFsYW5jZXIsIHJlc3VsdGluZyBpbiBhbiBlcnJvciBvbiB0aGUgc3Vic2VxdWVudCByZXF1ZXN0LiAgSWZcbiAgICogdGhpcyBzZXR0aW5nIGlzIHNldCB0byBhIGR1cmF0aW9uIGxlc3MgdGhhbiB0aGUgbG9hZCBiYWxhbmNlciB0aW1lb3V0LCB3ZSBjYW4gZW5zdXJlIHRoYXRcbiAgICogdGhlIGNvbm5lY3Rpb24gd2lsbCBiZSByZWZyZXNoZWQgdG8gYXZvaWQgZXJyb3JzLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0TWF4SWRsZU1pbGxpcygpOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBpbnRlcnZhbCB0aW1lIGluIG1pbGxpc2Vjb25kcyBmb3Igd2hlbiBlYWNoIGNhY2hlIGNsaWVudCBzaG91bGQgYmUgcmUtaW5pdGlhbGl6ZWQuXG4gICAqL1xuICBnZXRNYXhDbGllbnRBZ2VNaWxsaXMoKTogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBDb3B5IGNvbnN0cnVjdG9yIHRvIHVwZGF0ZSB0aGUgbWF4IGlkbGUgY29ubmVjdGlvbiB0aW1lb3V0LiAgKFNlZSB7Z2V0TWF4SWRsZU1pbGxpc30uKVxuICAgKiBAcGFyYW0ge251bWJlcn0gbWF4SWRsZU1pbGxpc1xuICAgKiBAcmV0dXJucyB7VHJhbnNwb3J0U3RyYXRlZ3l9IGEgbmV3IFRyYW5zcG9ydFN0cmF0ZWd5IHdpdGggdGhlIHNwZWNpZmllZCBtYXggaWRsZSBjb25uZWN0aW9uIHRpbWVvdXQuXG4gICAqL1xuICB3aXRoTWF4SWRsZU1pbGxpcyhtYXhJZGxlTWlsbGlzOiBudW1iZXIpOiBUcmFuc3BvcnRTdHJhdGVneTtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciB0byB1cGRhdGUgdGhlIG1heCBjbGllbnQgYWdlIGluIG1pbGxpcy4gIChTZWUge2dldE1heENsaWVudEFnZU1pbGxpc30uKVxuICAgKiBAcGFyYW0ge251bWJlcn0gbWF4Q2xpZW50QWdlTWlsbGlzXG4gICAqIEByZXR1cm5zIHtUcmFuc3BvcnRTdHJhdGVneX0gYSBuZXcgVHJhbnNwb3J0U3RyYXRlZ3kgd2l0aCB0aGUgc3BlY2lmaWVkIG1heCBjbGllbnQgYWdlLlxuICAgKi9cbiAgd2l0aE1heENsaWVudEFnZU1pbGxpcyhtYXhDbGllbnRBZ2VNaWxsaXM6IG51bWJlcik6IFRyYW5zcG9ydFN0cmF0ZWd5O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zcG9ydFN0cmF0ZWd5UHJvcHMge1xuICAvKipcbiAgICogbG93LWxldmVsIGdSUEMgc2V0dGluZ3MgZm9yIGNvbW11bmljYXRpb24gd2l0aCB0aGUgTW9tZW50byBzZXJ2ZXJcbiAgICovXG4gIGdycGNDb25maWd1cmF0aW9uOiBHcnBjQ29uZmlndXJhdGlvbjtcbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIGR1cmF0aW9uIGZvciB3aGljaCBhIGNvbm5lY3Rpb24gbWF5IHJlbWFpbiBpZGxlIGJlZm9yZSBiZWluZyByZXBsYWNlZC4gIFRoaXNcbiAgICogc2V0dGluZyBjYW4gYmUgdXNlZCB0byBmb3JjZSByZS1jb25uZWN0aW9uIG9mIGEgY2xpZW50IGlmIGl0IGhhcyBiZWVuIGlkbGUgZm9yIHRvbyBsb25nLlxuICAgKiBJbiBlbnZpcm9ubWVudHMgc3VjaCBhcyBBV1MgbGFtYmRhLCBpZiB0aGUgbGFtYmRhIGlzIHN1c3BlbmRlZCBmb3IgdG9vIGxvbmcgdGhlIGNvbm5lY3Rpb25cbiAgICogbWF5IGJlIGNsb3NlZCBieSB0aGUgbG9hZCBiYWxhbmNlciwgcmVzdWx0aW5nIGluIGFuIGVycm9yIG9uIHRoZSBzdWJzZXF1ZW50IHJlcXVlc3QuICBJZlxuICAgKiB0aGlzIHNldHRpbmcgaXMgc2V0IHRvIGEgZHVyYXRpb24gbGVzcyB0aGFuIHRoZSBsb2FkIGJhbGFuY2VyIHRpbWVvdXQsIHdlIGNhbiBlbnN1cmUgdGhhdFxuICAgKiB0aGUgY29ubmVjdGlvbiB3aWxsIGJlIHJlZnJlc2hlZCB0byBhdm9pZCBlcnJvcnMuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBtYXhJZGxlTWlsbGlzOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyB0aGUgaW50ZXJ2YWwgdGltZSBpbiBtaWxsaXNlY29uZHMgZm9yIHdoZW4gZWFjaCBjYWNoZSBjbGllbnQgc2hvdWxkIGJlIHJlLWluaXRpYWxpemVkLlxuICAgKi9cbiAgbWF4Q2xpZW50QWdlTWlsbGlzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24gaW1wbGVtZW50cyBHcnBjQ29uZmlndXJhdGlvbiB7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVhZGxpbmVNaWxsaXM6IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhTZXNzaW9uTWVtb3J5TWI6IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBudW1DbGllbnRzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkga2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzPzogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IGtlZXBBbGl2ZVRpbWVvdXRNcz86IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBrZWVwQWxpdmVUaW1lTXM/OiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4U2VuZE1lc3NhZ2VMZW5ndGg/OiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4UmVjZWl2ZU1lc3NhZ2VMZW5ndGg/OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IEdycGNDb25maWd1cmF0aW9uUHJvcHMpIHtcbiAgICB0aGlzLmRlYWRsaW5lTWlsbGlzID0gcHJvcHMuZGVhZGxpbmVNaWxsaXM7XG4gICAgdGhpcy5tYXhTZXNzaW9uTWVtb3J5TWIgPSBwcm9wcy5tYXhTZXNzaW9uTWVtb3J5TWI7XG4gICAgaWYgKHByb3BzLm51bUNsaWVudHMgIT09IHVuZGVmaW5lZCAmJiBwcm9wcy5udW1DbGllbnRzICE9PSBudWxsKSB7XG4gICAgICB0aGlzLm51bUNsaWVudHMgPSBwcm9wcy5udW1DbGllbnRzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGlzIGlzIHRoZSBwcmV2aW91c2x5IGhhcmRjb2RlZCB2YWx1ZSBhbmQgYSBzYWZlIGRlZmF1bHQgZm9yIG1vc3QgZW52aXJvbm1lbnRzLlxuICAgICAgdGhpcy5udW1DbGllbnRzID0gNjtcbiAgICB9XG4gICAgdGhpcy5rZWVwQWxpdmVUaW1lTXMgPSBwcm9wcy5rZWVwQWxpdmVUaW1lTXM7XG4gICAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0TXMgPSBwcm9wcy5rZWVwQWxpdmVUaW1lb3V0TXM7XG4gICAgdGhpcy5rZWVwQWxpdmVQZXJtaXRXaXRob3V0Q2FsbHMgPSBwcm9wcy5rZWVwQWxpdmVQZXJtaXRXaXRob3V0Q2FsbHM7XG4gICAgdGhpcy5tYXhTZW5kTWVzc2FnZUxlbmd0aCA9IHByb3BzLm1heFNlbmRNZXNzYWdlTGVuZ3RoO1xuICAgIHRoaXMubWF4UmVjZWl2ZU1lc3NhZ2VMZW5ndGggPSBwcm9wcy5tYXhSZWNlaXZlTWVzc2FnZUxlbmd0aDtcbiAgfVxuXG4gIGdldERlYWRsaW5lTWlsbGlzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZGVhZGxpbmVNaWxsaXM7XG4gIH1cblxuICBnZXRNYXhTZXNzaW9uTWVtb3J5TWIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5tYXhTZXNzaW9uTWVtb3J5TWI7XG4gIH1cblxuICBnZXRLZWVwQWxpdmVUaW1lb3V0TVMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5rZWVwQWxpdmVUaW1lb3V0TXM7XG4gIH1cblxuICBnZXRLZWVwQWxpdmVUaW1lTVMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5rZWVwQWxpdmVUaW1lTXM7XG4gIH1cblxuICBnZXRLZWVwQWxpdmVQZXJtaXRXaXRob3V0Q2FsbHMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5rZWVwQWxpdmVQZXJtaXRXaXRob3V0Q2FsbHM7XG4gIH1cblxuICB3aXRoRGVhZGxpbmVNaWxsaXMoZGVhZGxpbmVNaWxsaXM6IG51bWJlcik6IFN0YXRpY0dycGNDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gbmV3IFN0YXRpY0dycGNDb25maWd1cmF0aW9uKHtcbiAgICAgIGRlYWRsaW5lTWlsbGlzOiBkZWFkbGluZU1pbGxpcyxcbiAgICAgIG1heFNlc3Npb25NZW1vcnlNYjogdGhpcy5tYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgICBudW1DbGllbnRzOiB0aGlzLm51bUNsaWVudHMsXG4gICAgfSk7XG4gIH1cblxuICB3aXRoTWF4U2Vzc2lvbk1lbW9yeU1iKG1heFNlc3Npb25NZW1vcnlNYjogbnVtYmVyKTogU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiBuZXcgU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24oe1xuICAgICAgZGVhZGxpbmVNaWxsaXM6IHRoaXMuZGVhZGxpbmVNaWxsaXMsXG4gICAgICBtYXhTZXNzaW9uTWVtb3J5TWI6IG1heFNlc3Npb25NZW1vcnlNYixcbiAgICAgIG51bUNsaWVudHM6IHRoaXMubnVtQ2xpZW50cyxcbiAgICB9KTtcbiAgfVxuXG4gIGdldE1heFNlbmRNZXNzYWdlTGVuZ3RoKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMubWF4U2VuZE1lc3NhZ2VMZW5ndGg7XG4gIH1cblxuICBnZXRNYXhSZWNlaXZlTWVzc2FnZUxlbmd0aCgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLm1heFJlY2VpdmVNZXNzYWdlTGVuZ3RoO1xuICB9XG5cbiAgZ2V0TnVtQ2xpZW50cygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLm51bUNsaWVudHM7XG4gIH1cblxuICB3aXRoTnVtQ2xpZW50cyhudW1DbGllbnRzOiBudW1iZXIpOiBHcnBjQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICBkZWFkbGluZU1pbGxpczogdGhpcy5kZWFkbGluZU1pbGxpcyxcbiAgICAgIG1heFNlc3Npb25NZW1vcnlNYjogdGhpcy5tYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgICBudW1DbGllbnRzOiBudW1DbGllbnRzLFxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTdGF0aWNUcmFuc3BvcnRTdHJhdGVneSBpbXBsZW1lbnRzIFRyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgcHJpdmF0ZSByZWFkb25seSBncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbjtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhJZGxlTWlsbGlzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4Q2xpZW50QWdlTWlsbGlzPzogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBUcmFuc3BvcnRTdHJhdGVneVByb3BzKSB7XG4gICAgdGhpcy5ncnBjQ29uZmlnID0gcHJvcHMuZ3JwY0NvbmZpZ3VyYXRpb247XG4gICAgdGhpcy5tYXhJZGxlTWlsbGlzID0gcHJvcHMubWF4SWRsZU1pbGxpcztcbiAgICB0aGlzLm1heENsaWVudEFnZU1pbGxpcyA9IHByb3BzLm1heENsaWVudEFnZU1pbGxpcztcbiAgfVxuXG4gIGdldEdycGNDb25maWcoKTogR3JwY0NvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiB0aGlzLmdycGNDb25maWc7XG4gIH1cblxuICBnZXRNYXhDbGllbnRBZ2VNaWxsaXMoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tYXhDbGllbnRBZ2VNaWxsaXM7XG4gIH1cblxuICB3aXRoR3JwY0NvbmZpZyhncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbik6IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgICByZXR1cm4gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiBncnBjQ29uZmlnLFxuICAgICAgbWF4SWRsZU1pbGxpczogdGhpcy5tYXhJZGxlTWlsbGlzLFxuICAgICAgbWF4Q2xpZW50QWdlTWlsbGlzOiB0aGlzLm1heENsaWVudEFnZU1pbGxpcyxcbiAgICB9KTtcbiAgfVxuXG4gIGdldE1heElkbGVNaWxsaXMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5tYXhJZGxlTWlsbGlzO1xuICB9XG5cbiAgd2l0aE1heElkbGVNaWxsaXMobWF4SWRsZU1pbGxpczogbnVtYmVyKTogVHJhbnNwb3J0U3RyYXRlZ3kge1xuICAgIHJldHVybiBuZXcgU3RhdGljVHJhbnNwb3J0U3RyYXRlZ3koe1xuICAgICAgZ3JwY0NvbmZpZ3VyYXRpb246IHRoaXMuZ3JwY0NvbmZpZyxcbiAgICAgIG1heElkbGVNaWxsaXM6IG1heElkbGVNaWxsaXMsXG4gICAgICBtYXhDbGllbnRBZ2VNaWxsaXM6IHRoaXMubWF4Q2xpZW50QWdlTWlsbGlzLFxuICAgIH0pO1xuICB9XG5cbiAgd2l0aE1heENsaWVudEFnZU1pbGxpcyhtYXhDbGllbnRBZ2VNaWxsaXM6IG51bWJlcik6IFRyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgICByZXR1cm4gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiB0aGlzLmdycGNDb25maWcsXG4gICAgICBtYXhJZGxlTWlsbGlzOiB0aGlzLm1heElkbGVNaWxsaXMsXG4gICAgICBtYXhDbGllbnRBZ2VNaWxsaXM6IG1heENsaWVudEFnZU1pbGxpcyxcbiAgICB9KTtcbiAgfVxuXG4gIHdpdGhDbGllbnRUaW1lb3V0TWlsbGlzKGNsaWVudFRpbWVvdXQ6IG51bWJlcik6IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgICByZXR1cm4gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiB0aGlzLmdycGNDb25maWcud2l0aERlYWRsaW5lTWlsbGlzKGNsaWVudFRpbWVvdXQpLFxuICAgICAgbWF4SWRsZU1pbGxpczogdGhpcy5tYXhJZGxlTWlsbGlzLFxuICAgIH0pO1xuICB9XG59XG4iXX0=