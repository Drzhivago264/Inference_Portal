"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InRegion = exports.Lambda = exports.Laptop = void 0;
const configuration_1 = require("./configuration");
const fixed_count_retry_strategy_1 = require("./retry/fixed-count-retry-strategy");
const transport_1 = require("./transport");
const default_momento_logger_1 = require("./logging/default-momento-logger");
// 4 minutes.  We want to remain comfortably underneath the idle timeout for AWS NLB, which is 350s.
const defaultMaxIdleMillis = 4 * 60 * 1000;
const defaultMaxSessionMemoryMb = 256;
const defaultLoggerFactory = new default_momento_logger_1.DefaultMomentoLoggerFactory();
const defaultMiddlewares = [];
function defaultRetryStrategy(loggerFactory) {
    return new fixed_count_retry_strategy_1.FixedCountRetryStrategy({
        loggerFactory: loggerFactory,
        maxAttempts: 3,
    });
}
/**
 * Laptop config provides defaults suitable for a medium-to-high-latency dev environment.  Permissive timeouts, retries, and
 * relaxed latency and throughput targets.
 * @export
 * @class Laptop
 */
class Laptop extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for a laptop development environment.  NOTE: this configuration may
     * change in future releases to take advantage of improvements we identify for default configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return Laptop.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for a laptop development environment.  This configuration is guaranteed not
     * to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 5000;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
            keepAlivePermitWithoutCalls: 1,
            keepAliveTimeMs: 5000,
            keepAliveTimeoutMs: 1000,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new Laptop({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
            throwOnErrors: false,
        });
    }
}
exports.Laptop = Laptop;
class Lambda extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for a lambda environment.  NOTE: this configuration may
     * change in future releases to take advantage of improvements we identify for default configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 1100;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
            numClients: 1,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new Lambda({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
            throwOnErrors: false,
        });
    }
}
exports.Lambda = Lambda;
class InRegionDefault extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for a typical in-region environment.  NOTE: this configuration may
     * change in future releases to take advantage of improvements we identify for default configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return InRegionDefault.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for a typical in-region environment.  This configuration is guaranteed not
     * to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 1100;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
            keepAlivePermitWithoutCalls: 1,
            keepAliveTimeMs: 5000,
            keepAliveTimeoutMs: 1000,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new InRegionDefault({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
            throwOnErrors: false,
        });
    }
}
class InRegionLowLatency extends configuration_1.CacheConfiguration {
    /**
     * Provides the latest recommended configuration for an in-region environment with aggressive low-latency requirements.
     * NOTE: this configuration may change in future releases to take advantage of improvements we identify for default
     * configurations.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static latest(loggerFactory = defaultLoggerFactory) {
        return InRegionLowLatency.v1(loggerFactory);
    }
    /**
     * Provides v1 recommended configuration for an in-region environment with aggressive low-latency requirements.
     * This configuration is guaranteed not to change in future releases of the Momento node.js SDK.
     * @param {MomentoLoggerFactory} [loggerFactory=defaultLoggerFactory]
     * @returns {CacheConfiguration}
     */
    static v1(loggerFactory = defaultLoggerFactory) {
        const deadlineMillis = 500;
        const grpcConfig = new transport_1.StaticGrpcConfiguration({
            deadlineMillis: deadlineMillis,
            maxSessionMemoryMb: defaultMaxSessionMemoryMb,
            keepAlivePermitWithoutCalls: 1,
            keepAliveTimeMs: 5000,
            keepAliveTimeoutMs: 1000,
        });
        const transportStrategy = new transport_1.StaticTransportStrategy({
            grpcConfiguration: grpcConfig,
            maxIdleMillis: defaultMaxIdleMillis,
        });
        return new InRegionDefault({
            loggerFactory: loggerFactory,
            retryStrategy: defaultRetryStrategy(loggerFactory),
            transportStrategy: transportStrategy,
            middlewares: defaultMiddlewares,
            throwOnErrors: false,
        });
    }
}
/**
 * InRegion provides defaults suitable for an environment where your client is running in the same region as the Momento
 * service.  It has more aggressive timeouts and retry behavior than the Laptop config.
 * @export
 * @class InRegion
 */
class InRegion {
}
exports.InRegion = InRegion;
/**
 * This config prioritizes throughput and client resource utilization.  It has a slightly relaxed client-side timeout
 * setting to maximize throughput.
 * @type {InRegionDefault}
 */
InRegion.Default = InRegionDefault;
/**
 * This config prioritizes keeping p99.9 latencies as low as possible, potentially sacrificing
 * some throughput to achieve this.  It has a very aggressive client-side timeout.  Use this
 * configuration if the most important factor is to ensure that cache unavailability doesn't force
 * unacceptably high latencies for your own application.
 * @type {InRegionLowLatency}
 */
InRegion.LowLatency = InRegionLowLatency;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29uZmlnL2NvbmZpZ3VyYXRpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1EQUFtRDtBQUNuRCxtRkFBMkU7QUFJM0UsMkNBS3FCO0FBQ3JCLDZFQUE2RTtBQUU3RSxvR0FBb0c7QUFDcEcsTUFBTSxvQkFBb0IsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUssQ0FBQztBQUM1QyxNQUFNLHlCQUF5QixHQUFHLEdBQUcsQ0FBQztBQUN0QyxNQUFNLG9CQUFvQixHQUN4QixJQUFJLG9EQUEyQixFQUFFLENBQUM7QUFDcEMsTUFBTSxrQkFBa0IsR0FBaUIsRUFBRSxDQUFDO0FBRTVDLFNBQVMsb0JBQW9CLENBQzNCLGFBQW1DO0lBRW5DLE9BQU8sSUFBSSxvREFBdUIsQ0FBQztRQUNqQyxhQUFhLEVBQUUsYUFBYTtRQUM1QixXQUFXLEVBQUUsQ0FBQztLQUNmLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRDs7Ozs7R0FLRztBQUNILE1BQWEsTUFBTyxTQUFRLGtDQUFrQjtJQUM1Qzs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxNQUFNLENBQ1gsZ0JBQXNDLG9CQUFvQjtRQUUxRCxPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLEVBQUUsQ0FDUCxnQkFBc0Msb0JBQW9CO1FBRTFELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQztRQUM1QixNQUFNLFVBQVUsR0FBc0IsSUFBSSxtQ0FBdUIsQ0FBQztZQUNoRSxjQUFjLEVBQUUsY0FBYztZQUM5QixrQkFBa0IsRUFBRSx5QkFBeUI7WUFDN0MsMkJBQTJCLEVBQUUsQ0FBQztZQUM5QixlQUFlLEVBQUUsSUFBSTtZQUNyQixrQkFBa0IsRUFBRSxJQUFJO1NBQ3pCLENBQUMsQ0FBQztRQUNILE1B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LEVBQUUseUJBQXlCO1lBQzdDLDJCQUEyQixFQUFFLENBQUM7WUFDOUIsZUFBZSxFQUFFLElBQUk7WUFDckIsa0JBQWtCLEVBQUUsSUFBSTtTQUN6QixDQUFDLENBQUM7UUFDSCxNQUFNLGlCQUFpQixHQUFzQixJQUFJLG1DQUF1QixDQUFDO1lBQ3ZFLGlCQUFpQixFQUFFLFVBQVU7WUFDN0IsYUFBYSxFQUFFLG9CQUFvQjtTQUNwQyxDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksZUFBZSxDQUFDO1lBQ3pCLGFBQWEsRUFBRSxhQUFhO1lBQzVCLGFBQWEsRUFBRSxvQkFBb0IsQ0FBQyxhQUFhLENBQUM7WUFDbEQsaUJBQWlCLEVBQUUsaUJBQWlCO1lBQ3BDLFdBQVcsRUFBRSxrQkFBa0I7WUFDL0IsYUFBYSxFQUFFLEtBQUs7U0FDckIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBRUQ7Ozs7O0dBS0c7QUFDSCxNQUFhLFFBQVE7O0FBQXJCLDRCQWVDO0FBZEM7Ozs7R0FJRztBQUNJLGdCQUFPLEdBQUcsZUFBZSxDQUFDO0FBQ2pDOzs7Ozs7R0FNRztBQUNJLG1CQUFVLEdBQUcsa0JBQWtCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NhY2hlQ29uZmlndXJhdGlvbn0gZnJvbSAnLi9jb25maWd1cmF0aW9uJztcbmltcG9ydCB7Rml4ZWRDb3VudFJldHJ5U3RyYXRlZ3l9IGZyb20gJy4vcmV0cnkvZml4ZWQtY291bnQtcmV0cnktc3RyYXRlZ3knO1xuaW1wb3J0IHtSZXRyeVN0cmF0ZWd5fSBmcm9tICcuL3JldHJ5L3JldHJ5LXN0cmF0ZWd5JztcbmltcG9ydCB7TWlkZGxld2FyZX0gZnJvbSAnLi9taWRkbGV3YXJlL21pZGRsZXdhcmUnO1xuaW1wb3J0IHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gZnJvbSAnQGdvbW9tZW50by9zZGstY29yZSc7XG5pbXBvcnQge1xuICBHcnBjQ29uZmlndXJhdGlvbixcbiAgU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24sXG4gIFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5LFxuICBUcmFuc3BvcnRTdHJhdGVneSxcbn0gZnJvbSAnLi90cmFuc3BvcnQnO1xuaW1wb3J0IHtEZWZhdWx0TW9tZW50b0xvZ2dlckZhY3Rvcnl9IGZyb20gJy4vbG9nZ2luZy9kZWZhdWx0LW1vbWVudG8tbG9nZ2VyJztcblxuLy8gNCBtaW51dGVzLiAgV2Ugd2FudCB0byByZW1haW4gY29tZm9ydGFibHkgdW5kZXJuZWF0aCB0aGUgaWRsZSB0aW1lb3V0IGZvciBBV1MgTkxCLCB3aGljaCBpcyAzNTBzLlxuY29uc3QgZGVmYXVsdE1heElkbGVNaWxsaXMgPSA0ICogNjAgKiAxXzAwMDtcbmNvbnN0IGRlZmF1bHRNYXhTZXNzaW9uTWVtb3J5TWIgPSAyNTY7XG5jb25zdCBkZWZhdWx0TG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPVxuICBuZXcgRGVmYXVsdE1vbWVudG9Mb2dnZXJGYWN0b3J5KCk7XG5jb25zdCBkZWZhdWx0TWlkZGxld2FyZXM6IE1pZGRsZXdhcmVbXSA9IFtdO1xuXG5mdW5jdGlvbiBkZWZhdWx0UmV0cnlTdHJhdGVneShcbiAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3Rvcnlcbik6IFJldHJ5U3RyYXRlZ3kge1xuICByZXR1cm4gbmV3IEZpeGVkQ291bnRSZXRyeVN0cmF0ZWd5KHtcbiAgICBsb2dnZXJGYWN0b3J5OiBsb2dnZXJGYWN0b3J5LFxuICAgIG1heEF0dGVtcHRzOiAzLFxuICB9KTtcbn1cblxuLyoqXG4gKiBMYXB0b3AgY29uZmlnIHByb3ZpZGVzIGRlZmF1bHRzIHN1aXRhYmxlIGZvciBhIG1lZGl1bS10by1oaWdoLWxhdGVuY3kgZGV2IGVudmlyb25tZW50LiAgUGVybWlzc2l2ZSB0aW1lb3V0cywgcmV0cmllcywgYW5kXG4gKiByZWxheGVkIGxhdGVuY3kgYW5kIHRocm91Z2hwdXQgdGFyZ2V0cy5cbiAqIEBleHBvcnRcbiAqIEBjbGFzcyBMYXB0b3BcbiAqL1xuZXhwb3J0IGNsYXNzIExhcHRvcCBleHRlbmRzIENhY2hlQ29uZmlndXJhdGlvbiB7XG4gIC8qKlxuICAgKiBQcm92aWRlcyB0aGUgbGF0ZXN0IHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGEgbGFwdG9wIGRldmVsb3BtZW50IGVudmlyb25tZW50LiAgTk9URTogdGhpcyBjb25maWd1cmF0aW9uIG1heVxuICAgKiBjaGFuZ2UgaW4gZnV0dXJlIHJlbGVhc2VzIHRvIHRha2UgYWR2YW50YWdlIG9mIGltcHJvdmVtZW50cyB3ZSBpZGVudGlmeSBmb3IgZGVmYXVsdCBjb25maWd1cmF0aW9ucy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgbGF0ZXN0KFxuICAgIGxvZ2dlckZhY3Rvcnk6IE1vbWVudG9Mb2dnZXJGYWN0b3J5ID0gZGVmYXVsdExvZ2dlckZhY3RvcnlcbiAgKTogQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gTGFwdG9wLnYxKGxvZ2dlckZhY3RvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIHYxIHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGEgbGFwdG9wIGRldmVsb3BtZW50IGVudmlyb25tZW50LiAgVGhpcyBjb25maWd1cmF0aW9uIGlzIGd1YXJhbnRlZWQgbm90XG4gICAqIHRvIGNoYW5nZSBpbiBmdXR1cmUgcmVsZWFzZXMgb2YgdGhlIE1vbWVudG8gbm9kZS5qcyBTREsuXG4gICAqIEBwYXJhbSB7TW9tZW50b0xvZ2dlckZhY3Rvcnl9IFtsb2dnZXJGYWN0b3J5PWRlZmF1bHRMb2dnZXJGYWN0b3J5XVxuICAgKiBAcmV0dXJucyB7Q2FjaGVDb25maWd1cmF0aW9ufVxuICAgKi9cbiAgc3RhdGljIHYxKFxuICAgIGxvZ2dlckZhY3Rvcnk6IE1vbWVudG9Mb2dnZXJGYWN0b3J5ID0gZGVmYXVsdExvZ2dlckZhY3RvcnlcbiAgKTogQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgICBjb25zdCBkZWFkbGluZU1pbGxpcyA9IDUwMDA7XG4gICAgY29uc3QgZ3JwY0NvbmZpZzogR3JwY0NvbmZpZ3VyYXRpb24gPSBuZXcgU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24oe1xuICAgICAgZGVhZGxpbmVNaWxsaXM6IGRlYWRsaW5lTWlsbGlzLFxuICAgICAgbWF4U2Vzc2lvbk1lbW9yeU1iOiBkZWZhdWx0TWF4U2Vzc2lvbk1lbW9yeU1iLFxuICAgICAga2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzOiAxLFxuICAgICAga2VlcEFsaXZlVGltZU1zOiA1MDAwLFxuICAgICAga2VlcEFsaXZlVGltZW91dE1zOiAxMDAwLFxuICAgIH0pO1xuICAgIGNvbnN0IHRyYW5zcG9ydFN0cmF0ZWd5OiBUcmFuc3BvcnRTdHJhdGVneSA9IG5ldyBTdGF0aWNUcmFuc3BvcnRTdHJhdGVneSh7XG4gICAgICBncnBjQ29uZmlndXJhdGlvbjogZ3JwY0NvbmZpZyxcbiAgICAgIG1heElkbGVNaWxsaXM6IGRlZmF1bHRNYXhJZGxlTWlsbGlzLFxuICAgIH0pO1xuICAgIHJldHVybiBuZXcgTGFwdG9wKHtcbiAgICAgIGxvZ2dlckZhY3Rvcnk6IGxvZ2dlckZhY3RvcnksXG4gICAgICByZXRyeVN0cmF0ZWd5OiBkZWZhdWx0UmV0cnlTdHJhdGVneShsb2dnZXJGYWN0b3J5KSxcbiAgICAgIHRyYW5zcG9ydFN0cmF0ZWd5OiB0cmFuc3BvcnRTdHJhdGVneSxcbiAgICAgIG1pZGRsZXdhcmVzOiBkZWZhdWx0TWlkZGxld2FyZXMsXG4gICAgICB0aHJvd09uRXJyb3JzOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGFtYmRhIGV4dGVuZHMgQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgLyoqXG4gICAqIFByb3ZpZGVzIHRoZSBsYXRlc3QgcmVjb21tZW5kZWQgY29uZmlndXJhdGlvbiBmb3IgYSBsYW1iZGEgZW52aXJvbm1lbnQuICBOT1RFOiB0aGlzIGNvbmZpZ3VyYXRpb24gbWF5XG4gICAqIGNoYW5nZSBpbiBmdXR1cmUgcmVsZWFzZXMgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgaW1wcm92ZW1lbnRzIHdlIGlkZW50aWZ5IGZvciBkZWZhdWx0IGNvbmZpZ3VyYXRpb25zLlxuICAgKiBAcGFyYW0ge01vbWVudG9Mb2dnZXJGYWN0b3J5fSBbbG9nZ2VyRmFjdG9yeT1kZWZhdWx0TG9nZ2VyRmFjdG9yeV1cbiAgICogQHJldHVybnMge0NhY2hlQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIHN0YXRpYyBsYXRlc3QoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIGNvbnN0IGRlYWRsaW5lTWlsbGlzID0gMTEwMDtcbiAgICBjb25zdCBncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbiA9IG5ldyBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICBkZWFkbGluZU1pbGxpczogZGVhZGxpbmVNaWxsaXMsXG4gICAgICBtYXhTZXNzaW9uTWVtb3J5TWI6IGRlZmF1bHRNYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgICBudW1DbGllbnRzOiAxLFxuICAgIH0pO1xuICAgIGNvbnN0IHRyYW5zcG9ydFN0cmF0ZWd5OiBUcmFuc3BvcnRTdHJhdGVneSA9IG5ldyBTdGF0aWNUcmFuc3BvcnRTdHJhdGVneSh7XG4gICAgICBncnBjQ29uZmlndXJhdGlvbjogZ3JwY0NvbmZpZyxcbiAgICAgIG1heElkbGVNaWxsaXM6IGRlZmF1bHRNYXhJZGxlTWlsbGlzLFxuICAgIH0pO1xuICAgIHJldHVybiBuZXcgTGFtYmRhKHtcbiAgICAgIGxvZ2dlckZhY3Rvcnk6IGxvZ2dlckZhY3RvcnksXG4gICAgICByZXRyeVN0cmF0ZWd5OiBkZWZhdWx0UmV0cnlTdHJhdGVneShsb2dnZXJGYWN0b3J5KSxcbiAgICAgIHRyYW5zcG9ydFN0cmF0ZWd5OiB0cmFuc3BvcnRTdHJhdGVneSxcbiAgICAgIG1pZGRsZXdhcmVzOiBkZWZhdWx0TWlkZGxld2FyZXMsXG4gICAgICB0aHJvd09uRXJyb3JzOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxufVxuXG5jbGFzcyBJblJlZ2lvbkRlZmF1bHQgZXh0ZW5kcyBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAvKipcbiAgICogUHJvdmlkZXMgdGhlIGxhdGVzdCByZWNvbW1lbmRlZCBjb25maWd1cmF0aW9uIGZvciBhIHR5cGljYWwgaW4tcmVnaW9uIGVudmlyb25tZW50LiAgTk9URTogdGhpcyBjb25maWd1cmF0aW9uIG1heVxuICAgKiBjaGFuZ2UgaW4gZnV0dXJlIHJlbGVhc2VzIHRvIHRha2UgYWR2YW50YWdlIG9mIGltcHJvdmVtZW50cyB3ZSBpZGVudGlmeSBmb3IgZGVmYXVsdCBjb25maWd1cmF0aW9ucy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgbGF0ZXN0KFxuICAgIGxvZ2dlckZhY3Rvcnk6IE1vbWVudG9Mb2dnZXJGYWN0b3J5ID0gZGVmYXVsdExvZ2dlckZhY3RvcnlcbiAgKTogQ2FjaGVDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gSW5SZWdpb25EZWZhdWx0LnYxKGxvZ2dlckZhY3RvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIHYxIHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGEgdHlwaWNhbCBpbi1yZWdpb24gZW52aXJvbm1lbnQuICBUaGlzIGNvbmZpZ3VyYXRpb24gaXMgZ3VhcmFudGVlZCBub3RcbiAgICogdG8gY2hhbmdlIGluIGZ1dHVyZSByZWxlYXNlcyBvZiB0aGUgTW9tZW50byBub2RlLmpzIFNESy5cbiAgICogQHBhcmFtIHtNb21lbnRvTG9nZ2VyRmFjdG9yeX0gW2xvZ2dlckZhY3Rvcnk9ZGVmYXVsdExvZ2dlckZhY3RvcnldXG4gICAqIEByZXR1cm5zIHtDYWNoZUNvbmZpZ3VyYXRpb259XG4gICAqL1xuICBzdGF0aWMgdjEoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIGNvbnN0IGRlYWRsaW5lTWlsbGlzID0gMTEwMDtcbiAgICBjb25zdCBncnBjQ29uZmlnOiBHcnBjQ29uZmlndXJhdGlvbiA9IG5ldyBTdGF0aWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICBkZWFkbGluZU1pbGxpczogZGVhZGxpbmVNaWxsaXMsXG4gICAgICBtYXhTZXNzaW9uTWVtb3J5TWI6IGRlZmF1bHRNYXhTZXNzaW9uTWVtb3J5TWIsXG4gICAgICBrZWVwQWxpdmVQZXJtaXRXaXRob3V0Q2FsbHM6IDEsXG4gICAgICBrZWVwQWxpdmVUaW1lTXM6IDUwMDAsXG4gICAgICBrZWVwQWxpdmVUaW1lb3V0TXM6IDEwMDAsXG4gICAgfSk7XG4gICAgY29uc3QgdHJhbnNwb3J0U3RyYXRlZ3k6IFRyYW5zcG9ydFN0cmF0ZWd5ID0gbmV3IFN0YXRpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOiBncnBjQ29uZmlnLFxuICAgICAgbWF4SWRsZU1pbGxpczogZGVmYXVsdE1heElkbGVNaWxsaXMsXG4gICAgfSk7XG4gICAgcmV0dXJuIG5ldyBJblJlZ2lvbkRlZmF1bHQoe1xuICAgICAgbG9nZ2VyRmFjdG9yeTogbG9nZ2VyRmFjdG9yeSxcbiAgICAgIHJldHJ5U3RyYXRlZ3k6IGRlZmF1bHRSZXRyeVN0cmF0ZWd5KGxvZ2dlckZhY3RvcnkpLFxuICAgICAgdHJhbnNwb3J0U3RyYXRlZ3k6IHRyYW5zcG9ydFN0cmF0ZWd5LFxuICAgICAgbWlkZGxld2FyZXM6IGRlZmF1bHRNaWRkbGV3YXJlcyxcbiAgICAgIHRocm93T25FcnJvcnM6IGZhbHNlLFxuICAgIH0pO1xuICB9XG59XG5cbmNsYXNzIEluUmVnaW9uTG93TGF0ZW5jeSBleHRlbmRzIENhY2hlQ29uZmlndXJhdGlvbiB7XG4gIC8qKlxuICAgKiBQcm92aWRlcyB0aGUgbGF0ZXN0IHJlY29tbWVuZGVkIGNvbmZpZ3VyYXRpb24gZm9yIGFuIGluLXJlZ2lvbiBlbnZpcm9ubWVudCB3aXRoIGFnZ3Jlc3NpdmUgbG93LWxhdGVuY3kgcmVxdWlyZW1lbnRzLlxuICAgKiBOT1RFOiB0aGlzIGNvbmZpZ3VyYXRpb24gbWF5IGNoYW5nZSBpbiBmdXR1cmUgcmVsZWFzZXMgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgaW1wcm92ZW1lbnRzIHdlIGlkZW50aWZ5IGZvciBkZWZhdWx0XG4gICAqIGNvbmZpZ3VyYXRpb25zLlxuICAgKiBAcGFyYW0ge01vbWVudG9Mb2dnZXJGYWN0b3J5fSBbbG9nZ2VyRmFjdG9yeT1kZWZhdWx0TG9nZ2VyRmFjdG9yeV1cbiAgICogQHJldHVybnMge0NhY2hlQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIHN0YXRpYyBsYXRlc3QoXG4gICAgbG9nZ2VyRmFjdG9yeTogTW9tZW50b0xvZ2dlckZhY3RvcnkgPSBkZWZhdWx0TG9nZ2VyRmFjdG9yeVxuICApOiBDYWNoZUNvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiBJblJlZ2lvbkxvd0xhdGVuY3kudjEobG9nZ2VyRmFjdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgdjEgcmVjb21tZW5kZWQgY29uZmlndXJhdGlvbiBmb3IgYW4gaW4tcmVnaW9uIGVudmlyb25tZW50IHdpdGggYWdncmVzc2l2ZSBsb3ctbGF0ZW5jeSByZXF1aXJlbWVudHMuXG4gICAqIFRoaXMgY29uZmlndXJhdGlvbiBpcyBndWFyYW50ZWVkIG5vdCB0byBjaGFuZ2UgaW4gZnV0dXJlIHJlbGVhc2VzIG9mIHRoZSBNb21lbnRvIG5vZGUuanMgU0RLLlxuICAgKiBAcGFyYW0ge01vbWVudG9Mb2dnZXJGYWN0b3J5fSBbbG9nZ2VyRmFjdG9yeT1kZWZhdWx0TG9nZ2VyRmFjdG9yeV1cbiAgICogQHJldHVybnMge0NhY2hlQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIHN0YXRpYyB2MShcbiAgICBsb2dnZXJGYWN0b3J5OiBNb21lbnRvTG9nZ2VyRmFjdG9yeSA9IGRlZmF1bHRMb2dnZXJGYWN0b3J5XG4gICk6IENhY2hlQ29uZmlndXJhdGlvbiB7XG4gICAgY29uc3QgZGVhZGxpbmVNaWxsaXMgPSA1MDA7XG4gICAgY29uc3QgZ3JwY0NvbmZpZzogR3JwY0NvbmZpZ3VyYXRpb24gPSBuZXcgU3RhdGljR3JwY0NvbmZpZ3VyYXRpb24oe1xuICAgICAgZGVhZGxpbmVNaWxsaXM6IGRlYWRsaW5lTWlsbGlzLFxuICAgICAgbWF4U2Vzc2lvbk1lbW9yeU1iOiBkZWZhdWx0TWF4U2Vzc2lvbk1lbW9yeU1iLFxuICAgICAga2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzOiAxLFxuICAgICAga2VlcEFsaXZlVGltZU1zOiA1MDAwLFxuICAgICAga2VlcEFsaXZlVGltZW91dE1zOiAxMDAwLFxuICAgIH0pO1xuICAgIGNvbnN0IHRyYW5zcG9ydFN0cmF0ZWd5OiBUcmFuc3BvcnRTdHJhdGVneSA9IG5ldyBTdGF0aWNUcmFuc3BvcnRTdHJhdGVneSh7XG4gICAgICBncnBjQ29uZmlndXJhdGlvbjogZ3JwY0NvbmZpZyxcbiAgICAgIG1heElkbGVNaWxsaXM6IGRlZmF1bHRNYXhJZGxlTWlsbGlzLFxuICAgIH0pO1xuICAgIHJldHVybiBuZXcgSW5SZWdpb25EZWZhdWx0KHtcbiAgICAgIGxvZ2dlckZhY3Rvcnk6IGxvZ2dlckZhY3RvcnksXG4gICAgICByZXRyeVN0cmF0ZWd5OiBkZWZhdWx0UmV0cnlTdHJhdGVneShsb2dnZXJGYWN0b3J5KSxcbiAgICAgIHRyYW5zcG9ydFN0cmF0ZWd5OiB0cmFuc3BvcnRTdHJhdGVneSxcbiAgICAgIG1pZGRsZXdhcmVzOiBkZWZhdWx0TWlkZGxld2FyZXMsXG4gICAgICB0aHJvd09uRXJyb3JzOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIEluUmVnaW9uIHByb3ZpZGVzIGRlZmF1bHRzIHN1aXRhYmxlIGZvciBhbiBlbnZpcm9ubWVudCB3aGVyZSB5b3VyIGNsaWVudCBpcyBydW5uaW5nIGluIHRoZSBzYW1lIHJlZ2lvbiBhcyB0aGUgTW9tZW50b1xuICogc2VydmljZS4gIEl0IGhhcyBtb3JlIGFnZ3Jlc3NpdmUgdGltZW91dHMgYW5kIHJldHJ5IGJlaGF2aW9yIHRoYW4gdGhlIExhcHRvcCBjb25maWcuXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgSW5SZWdpb25cbiAqL1xuZXhwb3J0IGNsYXNzIEluUmVnaW9uIHtcbiAgLyoqXG4gICAqIFRoaXMgY29uZmlnIHByaW9yaXRpemVzIHRocm91Z2hwdXQgYW5kIGNsaWVudCByZXNvdXJjZSB1dGlsaXphdGlvbi4gIEl0IGhhcyBhIHNsaWdodGx5IHJlbGF4ZWQgY2xpZW50LXNpZGUgdGltZW91dFxuICAgKiBzZXR0aW5nIHRvIG1heGltaXplIHRocm91Z2hwdXQuXG4gICAqIEB0eXBlIHtJblJlZ2lvbkRlZmF1bHR9XG4gICAqL1xuICBzdGF0aWMgRGVmYXVsdCA9IEluUmVnaW9uRGVmYXVsdDtcbiAgLyoqXG4gICAqIFRoaXMgY29uZmlnIHByaW9yaXRpemVzIGtlZXBpbmcgcDk5LjkgbGF0ZW5jaWVzIGFzIGxvdyBhcyBwb3NzaWJsZSwgcG90ZW50aWFsbHkgc2FjcmlmaWNpbmdcbiAgICogc29tZSB0aHJvdWdocHV0IHRvIGFjaGlldmUgdGhpcy4gIEl0IGhhcyBhIHZlcnkgYWdncmVzc2l2ZSBjbGllbnQtc2lkZSB0aW1lb3V0LiAgVXNlIHRoaXNcbiAgICogY29uZmlndXJhdGlvbiBpZiB0aGUgbW9zdCBpbXBvcnRhbnQgZmFjdG9yIGlzIHRvIGVuc3VyZSB0aGF0IGNhY2hlIHVuYXZhaWxhYmlsaXR5IGRvZXNuJ3QgZm9yY2VcbiAgICogdW5hY2NlcHRhYmx5IGhpZ2ggbGF0ZW5jaWVzIGZvciB5b3VyIG93biBhcHBsaWNhdGlvbi5cbiAgICogQHR5cGUge0luUmVnaW9uTG93TGF0ZW5jeX1cbiAgICovXG4gIHN0YXRpYyBMb3dMYXRlbmN5ID0gSW5SZWdpb25Mb3dMYXRlbmN5O1xufVxuIl19