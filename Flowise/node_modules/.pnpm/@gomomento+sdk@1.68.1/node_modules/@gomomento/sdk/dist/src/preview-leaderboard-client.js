"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PreviewLeaderboardClient = void 0;
const leaderboard_data_client_1 = require("./internal/leaderboard-data-client");
const leaderboard_1 = require("./internal/leaderboard");
const index_1 = require("./index");
/**
 * PREVIEW Momento Leaderboard Client
 * WARNING: the API for this client is not yet stable and may change without notice.
 * Please contact Momento if you would like to try this preview.
 *
 * Leaderboard methods return a response object unique to each request.
 * The response object is resolved to a type-safe object of one of several
 * sub-types. See the documentation for each response type for details.
 */
class PreviewLeaderboardClient {
    constructor(props) {
        var _a;
        const configuration = (_a = props.configuration) !== null && _a !== void 0 ? _a : getDefaultLeaderboardConfiguration();
        const propsWithConfig = {
            ...props,
            configuration: configuration,
        };
        this.configuration = configuration;
        this.logger = configuration.getLoggerFactory().getLogger(this);
        this.logger.debug('Creating Momento LeaderboardClient');
        this.dataClient = new leaderboard_data_client_1.LeaderboardDataClient(propsWithConfig, '0'); // only creating one leaderboard client
    }
    close() {
        this.dataClient.close();
        this.configuration.getMiddlewares().forEach(m => {
            if (m.close) {
                m.close();
            }
        });
    }
    /**
     * Creates an instance of LeaderboardClient with floating point scores up until 53 bits of precision.
     */
    leaderboard(cacheName, leaderboardName) {
        return new leaderboard_1.Leaderboard(this.dataClient, cacheName, leaderboardName);
    }
}
exports.PreviewLeaderboardClient = PreviewLeaderboardClient;
function getDefaultLeaderboardConfiguration() {
    return index_1.LeaderboardConfigurations.Laptop.latest();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJldmlldy1sZWFkZXJib2FyZC1jbGllbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcHJldmlldy1sZWFkZXJib2FyZC1jbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBS0EsZ0ZBQXlFO0FBRXpFLHdEQUFtRDtBQUVuRCxtQ0FBNEU7QUFHNUU7Ozs7Ozs7O0dBUUc7QUFDSCxNQUFhLHdCQUF3QjtJQUtuQyxZQUFZLEtBQTZCOztRQUN2QyxNQUFNLGFBQWEsR0FDakIsTUFBQSxLQUFLLENBQUMsYUFBYSxtQ0FBSSxrQ0FBa0MsRUFBRSxDQUFDO1FBQzlELE1BQU0sZUFBZSxHQUFxQztZQUN4RCxHQUFHLEtBQUs7WUFDUixhQUFhLEVBQUUsYUFBYTtTQUM3QixDQUFDO1FBQ0YsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7UUFFbkMsSUFBSSxDQUFDLE1BQU0sR0FBRyxhQUFhLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsb0NBQW9DLENBQUMsQ0FBQztRQUN4RCxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksK0NBQXFCLENBQUMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsdUNBQXVDO0lBQzVHLENBQUM7SUFFTSxLQUFLO1FBQ1YsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsYUFBYSxDQUFDLGNBQWMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUM5QyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUU7Z0JBQ1gsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQ1g7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxTQUFpQixFQUFFLGVBQXVCO1FBQzNELE9BQU8sSUFBSSx5QkFBVyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsU0FBUyxFQUFFLGVBQWUsQ0FBQyxDQUFDO0lBQ3RFLENBQUM7Q0FDRjtBQWxDRCw0REFrQ0M7QUFFRCxTQUFTLGtDQUFrQztJQUN6QyxPQUFPLGlDQUF5QixDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNuRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgTW9tZW50b0xvZ2dlcixcbiAgSUxlYWRlcmJvYXJkQ2xpZW50LFxuICBJTGVhZGVyYm9hcmQsXG59IGZyb20gJ0Bnb21vbWVudG8vc2RrLWNvcmUnO1xuaW1wb3J0IHtMZWFkZXJib2FyZERhdGFDbGllbnR9IGZyb20gJy4vaW50ZXJuYWwvbGVhZGVyYm9hcmQtZGF0YS1jbGllbnQnO1xuaW1wb3J0IHtMZWFkZXJib2FyZENsaWVudFByb3BzfSBmcm9tICcuL2xlYWRlcmJvYXJkLWNsaWVudC1wcm9wcyc7XG5pbXBvcnQge0xlYWRlcmJvYXJkfSBmcm9tICcuL2ludGVybmFsL2xlYWRlcmJvYXJkJztcbmltcG9ydCB7SUxlYWRlcmJvYXJkRGF0YUNsaWVudH0gZnJvbSAnQGdvbW9tZW50by9zZGstY29yZS9kaXN0L3NyYy9pbnRlcm5hbC9jbGllbnRzL2xlYWRlcmJvYXJkL0lMZWFkZXJib2FyZERhdGFDbGllbnQnO1xuaW1wb3J0IHtMZWFkZXJib2FyZENvbmZpZ3VyYXRpb24sIExlYWRlcmJvYXJkQ29uZmlndXJhdGlvbnN9IGZyb20gJy4vaW5kZXgnO1xuaW1wb3J0IHtMZWFkZXJib2FyZENsaWVudFByb3BzV2l0aENvbmZpZ30gZnJvbSAnLi9pbnRlcm5hbC9sZWFkZXJib2FyZC1jbGllbnQtcHJvcHMtd2l0aC1jb25maWcnO1xuXG4vKipcbiAqIFBSRVZJRVcgTW9tZW50byBMZWFkZXJib2FyZCBDbGllbnRcbiAqIFdBUk5JTkc6IHRoZSBBUEkgZm9yIHRoaXMgY2xpZW50IGlzIG5vdCB5ZXQgc3RhYmxlIGFuZCBtYXkgY2hhbmdlIHdpdGhvdXQgbm90aWNlLlxuICogUGxlYXNlIGNvbnRhY3QgTW9tZW50byBpZiB5b3Ugd291bGQgbGlrZSB0byB0cnkgdGhpcyBwcmV2aWV3LlxuICpcbiAqIExlYWRlcmJvYXJkIG1ldGhvZHMgcmV0dXJuIGEgcmVzcG9uc2Ugb2JqZWN0IHVuaXF1ZSB0byBlYWNoIHJlcXVlc3QuXG4gKiBUaGUgcmVzcG9uc2Ugb2JqZWN0IGlzIHJlc29sdmVkIHRvIGEgdHlwZS1zYWZlIG9iamVjdCBvZiBvbmUgb2Ygc2V2ZXJhbFxuICogc3ViLXR5cGVzLiBTZWUgdGhlIGRvY3VtZW50YXRpb24gZm9yIGVhY2ggcmVzcG9uc2UgdHlwZSBmb3IgZGV0YWlscy5cbiAqL1xuZXhwb3J0IGNsYXNzIFByZXZpZXdMZWFkZXJib2FyZENsaWVudCBpbXBsZW1lbnRzIElMZWFkZXJib2FyZENsaWVudCB7XG4gIHByb3RlY3RlZCByZWFkb25seSBsb2dnZXI6IE1vbWVudG9Mb2dnZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGF0YUNsaWVudDogSUxlYWRlcmJvYXJkRGF0YUNsaWVudDtcbiAgcHJpdmF0ZSByZWFkb25seSBjb25maWd1cmF0aW9uOiBMZWFkZXJib2FyZENvbmZpZ3VyYXRpb247XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IExlYWRlcmJvYXJkQ2xpZW50UHJvcHMpIHtcbiAgICBjb25zdCBjb25maWd1cmF0aW9uID1cbiAgICAgIHByb3BzLmNvbmZpZ3VyYXRpb24gPz8gZ2V0RGVmYXVsdExlYWRlcmJvYXJkQ29uZmlndXJhdGlvbigpO1xuICAgIGNvbnN0IHByb3BzV2l0aENvbmZpZzogTGVhZGVyYm9hcmRDbGllbnRQcm9wc1dpdGhDb25maWcgPSB7XG4gICAgICAuLi5wcm9wcyxcbiAgICAgIGNvbmZpZ3VyYXRpb246IGNvbmZpZ3VyYXRpb24sXG4gICAgfTtcbiAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uO1xuXG4gICAgdGhpcy5sb2dnZXIgPSBjb25maWd1cmF0aW9uLmdldExvZ2dlckZhY3RvcnkoKS5nZXRMb2dnZXIodGhpcyk7XG4gICAgdGhpcy5sb2dnZXIuZGVidWcoJ0NyZWF0aW5nIE1vbWVudG8gTGVhZGVyYm9hcmRDbGllbnQnKTtcbiAgICB0aGlzLmRhdGFDbGllbnQgPSBuZXcgTGVhZGVyYm9hcmREYXRhQ2xpZW50KHByb3BzV2l0aENvbmZpZywgJzAnKTsgLy8gb25seSBjcmVhdGluZyBvbmUgbGVhZGVyYm9hcmQgY2xpZW50XG4gIH1cblxuICBwdWJsaWMgY2xvc2UoKSB7XG4gICAgdGhpcy5kYXRhQ2xpZW50LmNsb3NlKCk7XG4gICAgdGhpcy5jb25maWd1cmF0aW9uLmdldE1pZGRsZXdhcmVzKCkuZm9yRWFjaChtID0+IHtcbiAgICAgIGlmIChtLmNsb3NlKSB7XG4gICAgICAgIG0uY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIExlYWRlcmJvYXJkQ2xpZW50IHdpdGggZmxvYXRpbmcgcG9pbnQgc2NvcmVzIHVwIHVudGlsIDUzIGJpdHMgb2YgcHJlY2lzaW9uLlxuICAgKi9cbiAgcHVibGljIGxlYWRlcmJvYXJkKGNhY2hlTmFtZTogc3RyaW5nLCBsZWFkZXJib2FyZE5hbWU6IHN0cmluZyk6IElMZWFkZXJib2FyZCB7XG4gICAgcmV0dXJuIG5ldyBMZWFkZXJib2FyZCh0aGlzLmRhdGFDbGllbnQsIGNhY2hlTmFtZSwgbGVhZGVyYm9hcmROYW1lKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXREZWZhdWx0TGVhZGVyYm9hcmRDb25maWd1cmF0aW9uKCk6IExlYWRlcmJvYXJkQ29uZmlndXJhdGlvbiB7XG4gIHJldHVybiBMZWFkZXJib2FyZENvbmZpZ3VyYXRpb25zLkxhcHRvcC5sYXRlc3QoKTtcbn1cbiJdfQ==