"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ClientTimeoutInterceptor = void 0;
const grpc_js_1 = require("@grpc/grpc-js");
const ClientTimeoutInterceptor = (requestTimeoutMs) => {
    return (options, nextCall) => {
        if (!options.deadline) {
            const deadline = new Date(Date.now());
            deadline.setMilliseconds(deadline.getMilliseconds() + requestTimeoutMs);
            options.deadline = deadline;
        }
        return new grpc_js_1.InterceptingCall(nextCall(options));
    };
};
exports.ClientTimeoutInterceptor = ClientTimeoutInterceptor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LXRpbWVvdXQtaW50ZXJjZXB0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvaW50ZXJuYWwvZ3JwYy9jbGllbnQtdGltZW91dC1pbnRlcmNlcHRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwyQ0FBNEQ7QUFFckQsTUFBTSx3QkFBd0IsR0FBRyxDQUN0QyxnQkFBd0IsRUFDWCxFQUFFO0lBQ2YsT0FBTyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsRUFBRTtRQUMzQixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRTtZQUNyQixNQUFNLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUN0QyxRQUFRLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3hFLE9BQU8sQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1NBQzdCO1FBQ0QsT0FBTyxJQUFJLDBCQUFnQixDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ2pELENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQVhXLFFBQUEsd0JBQXdCLDRCQVduQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SW50ZXJjZXB0aW5nQ2FsbCwgSW50ZXJjZXB0b3J9IGZyb20gJ0BncnBjL2dycGMtanMnO1xuXG5leHBvcnQgY29uc3QgQ2xpZW50VGltZW91dEludGVyY2VwdG9yID0gKFxuICByZXF1ZXN0VGltZW91dE1zOiBudW1iZXJcbik6IEludGVyY2VwdG9yID0+IHtcbiAgcmV0dXJuIChvcHRpb25zLCBuZXh0Q2FsbCkgPT4ge1xuICAgIGlmICghb3B0aW9ucy5kZWFkbGluZSkge1xuICAgICAgY29uc3QgZGVhZGxpbmUgPSBuZXcgRGF0ZShEYXRlLm5vdygpKTtcbiAgICAgIGRlYWRsaW5lLnNldE1pbGxpc2Vjb25kcyhkZWFkbGluZS5nZXRNaWxsaXNlY29uZHMoKSArIHJlcXVlc3RUaW1lb3V0TXMpO1xuICAgICAgb3B0aW9ucy5kZWFkbGluZSA9IGRlYWRsaW5lO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEludGVyY2VwdGluZ0NhbGwobmV4dENhbGwob3B0aW9ucykpO1xuICB9O1xufTtcbiJdfQ==