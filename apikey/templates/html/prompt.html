<!DOCTYPE HTML>
<html>


<head>
  <title>Static Prompt</title>
  <meta name="description" content="website description" />
  <meta name="keywords" content="website keywords, website keywords" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <link rel="stylesheet" href="static/css/pico-main/css/pico.min.css" />
  <link rel="stylesheet" href="static/css/pico-main/css/pico.colors.min.css" />
  <link rel="shortcut icon" type="image/png" href="static/image/favicon.ico" />
  <link href="static/css/prism.css" rel="stylesheet" />
  <script src="static/js/prism.js"></script>
</head>
<style>
  #chat-log {
    width: 100% !important;
    resize: vertical;
    background-color: rgb(37, 37, 37);
    color: white;
    border: 1px solid #ccc;
    box-sizing: border-box;
    height: 20vh;
    overflow: auto;
  }

  .message_log_container {
    margin: 10px;
  }
</style>

<body>
  <header class="container">
    <nav>
      <ul>
        <hgroup  onclick="window.location.href = '/';">
          <h1><b>Inference</b></h1>
        </hgroup>
      </ul>
      <ul>
        <li>
          <details  class="dropdown">
            <summary >
              About
            </summary>
            <ul dir="rtl">
              <li><a  href="/">Introduction</a></li>
              <li><a  href="/model_infor">Model</a></li>
              <li><a  href="/manual">User Manual</a></li>
              <li><a href="/contact">Contact Us</a></li>
            </ul>
          </details> 
        </li>
       
        <li>
          <details  class="dropdown">
            <summary role="button" class="outline">
              Modes
            </summary>
            <ul dir="rtl">
              <li><a aria-current="page" href="/prompt">Prompt and API</a></li>
              <li><a href="/chat">Chat Bot and Agent</a></li>
            </ul>
          </details>
        </li> 
        <li><a class="contrast" href="/buy">Get Key</a></li>
        <li><a class="contrast" href="/promptresponse">Response Log</a></li>
      </ul>
    </nav>
  </header>
  <hr>
  <main class="container">
    <div id="site_content" style="grid-template-columns: 70% 30%;" class="grid">
     
      <div class="container" id="content">
        <h2>Prompt testing/Server warm up</h2>

        <form autocomplete="off" method="post">
          {% csrf_token %}
          <div class="form_settings">
            <input type="hidden" name="form_type" value="prompt">
            <input  placeholder="Key name" type="password" name="name" />
            <input type="text" placeholder="Key" name="key" />
          
            <textarea  placeholder="Prompt" rows="8" cols="50" name="prompt"></textarea>
            <div class="grid">
              <div class="container">
                <h3> Available Models </h3>
                {% for llm in llms %}
                    {% if llm.name == 'Mistral Chat 13B' %}
                        <input type="radio" class= "checkbox" name="model"  value= "{{llm.name}}" checked="checked"> {{llm.name}}<br>
                    {% else %}
                        <input type="radio" class= "checkbox" name="model"  value= "{{llm.name}}"> {{llm.name}}<br>
                    {% endif %}
                {% endfor %}
              </div>
              <div class="container">
                <h3> Parameters </h3>
                <input type="radio" class= "checkbox" name="mode"  value= "chat"> Chat Bot Mode<br>
                <input type="radio" class= "checkbox" name="mode"  value= "generate"   checked="checked"> Sentence Completion
              </div>
            </div>
            <hr>
            <small><i>NOTE: If the default parameters does not work for you, you can adjust them here.</i></small><br>
            <small><i>NOTE: In order to better understand these parameters, refer to <a href='https://huggingface.co/blog/how-to-generate'> This Blog </a> or <a href='https://github.com/vllm-project/vllm/blob/main/vllm/sampling_params.py'> This Code. </a> </i></small>                  
            <hr>
            <div class="grid" >
              <div class="container">
                <label for="top_p">Top_p:</label>
                <div class="grid" style="grid-template-columns: 80% 20%;"> 
                  <input type="range"  step=".001"  name="top_p" min="0.01" max="1" value="0.73" oninput="this.nextElementSibling.value = this.value">
                  <output>0.73</output>
                </div><br>
                <label for="top_k" >Top_k:</label>
                <div class="grid" style="grid-template-columns: 80% 20%;"> 
                  <input type="range"  step="1"  name="top_k" min="0" max="100" value="-1" oninput="this.nextElementSibling.value = this.value">
                  <output>-1</output>
                </div><br>
                <label for="max_tokens">Max_tokens:</label>
                <div class="grid" style="grid-template-columns: 80% 20%;"> 
                  <input type="range"  step="1"  name="max_tokens" min="1" max="4096" value="128" oninput="this.nextElementSibling.value = this.value">
                  <output>128</output>
                </div>
              </div>
              <div class="container">
                <label for="temperature">Temperature:</label>
            <div class="grid" style="grid-template-columns: 80% 20%;"> 
                <input type="range"  step=".001"  name="temperature" min="0" max="1" value="0.72" oninput="this.nextElementSibling.value = this.value">
                <output>0.72</output>
              </div><br>
              <label for="frequency_penalty">Frequency penalty:</label>
              <div class="grid" style="grid-template-columns: 80% 20%;"> 
                <input type="range"  step=".001"  name="frequency_penalty" min="-2" max="2" value="0" oninput="this.nextElementSibling.value = this.value">
                <output>0</output>
              </div><br>
              <label for="presence_penalty">Presence penalty:</label>
              <div class="grid" style="grid-template-columns: 80% 20%;"> 
                <input type="range"  step=".001"  name="presence_penalty" min="-2" max="2" value="0" oninput="this.nextElementSibling.value = this.value">
                <output>0</output>
              </div>
              </div>
            </div>
 
            
            <hr>
            <small><i>NOTE: These parameters go along with each others, please know what you are doing.</i></small><br>
            <small><i>NOTE: Return to default value if you messed up the parameters</i></small>
            <hr>
            <input  type="checkbox" class= "checkbox_beam" name="beam" id = "beam" > Beam Search (default = False) 
            <input  type="checkbox" class= "checkbox_early_stopping" name="early_stopping" id ="early_stopping" > Early Stop (default = False) <br> <br>
            <input style="width: 10ch;" type="number" step="any" name="length_penalty" min="-2" max="2" value="0"> Length Penalty (default = 0)<br>
            <input style="width: 10ch;" type="number" step="1" name="best_of" min="1" max="5" value="1"> Best of (default = 2 for beam search, 1 for sampling) <br>
            <p style="padding-top: 15px"><span>&nbsp;</span><input class="submit" type="submit" value="Submit" /></p>
          </div>

        </form>
      </div>
      <div class="container"   id="content">
        <!-- insert your sidebar items here -->
        <h2>Status</h2>
        <div id="chat-log">
          <p>
            {%for message in messages %}
          <div class="message_log_container"
            style="text-align: left; word-wrap: break-word; overflow-wrap: break-word;"><span> {{ message }}</span>
          </div>
          {% endfor %}
          </p>
        </div><br>
        <h2>Response Log</h2>
        <h4>You can check your response log here:</h4>
        <form method="post">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="checklog">
          <input placeholder="Key" type="text" style="float: right;" size="20" name="key" /> <br>
          <input placeholder="Key name" type="password" style="float: right;" size="20" name="name" />
          <input class="submit" style="float: right;" type="submit" value=" Check " />
       
        </form>
        <h2>API Endpoints</h2>
        <h4>Python example for chat endpoint:</h4>

        <pre style="font-size: 14px;"><code class="language-Python" data-prismjs-copy="Copy" >response = requests.post("https://professorparakeet.com/api/chat", headers={"Authorization": "Bearer str"}, 
json={"prompt": str,
  "model" : str,
  'top_k': int,
  'top_p': float,
  'best_of': int,
  'max_tokens': int,
  'frequency_penalty': float,
  'presence_penalty': float,
  'temperature': float,
  'beam': bool,
  'early_stopping': bool,
  'length_penalty': float
}) 
print(response.json())
        </code></pre>

        <h4>cURL example for text completion endpoint:</h4>
        <pre style="font-size: 14px;"><code class="language-bash" >curl "https://professorparakeet.com/api/completion" --request POST \
-H "Authorization: Bearer str" -H 'Content-Type: application/json' \
--data-binary '{"prompt": str, 
            "model" : str,
            "top_k": int,
            "top_p": float,
            "best_of": int,
            "max_tokens": int,
            "frequency_penalty": float,
            "presence_penalty": float,
            "temperature": float,
            "beam": bool,
            "early_stopping": bool,
            "length_penalty": float
          }'
</code></pre>
        <p><a href="/api/docs">Test API</a></p>
        <p></p>


      </div>
    </div>

  </div>
</body>
</html>